
echo $1
/tmp/clevor/tests

mkdir $1 || exit 1
cd $1

nix build git+https://git.lix.systems/lix-project/lix?rev=95f15cf94fb621795eb854db6d0387cfd22cd310 -o lix >& /dev/null || exit 1
nix build github:NixOS/nix/4a2fb18ba00b0771652f4d5d047910e2e41e238d -o nix >& /dev/null || exit 1
# narz fails in f790364c93142affa3cc699365545d6a11916a76
nix build git+https://git.sr.ht/~watersucks/narz?rev=760736b98e08c7c741838f5ad020d6d2e33b5e57 -o narz >& /dev/null || exit 1
nix build git+https://codeberg.org/clevor/narser?rev=1171b78ee5e96679fa4826b8b9f75ee6c3c7ff5a -o narser >& /dev/null || exit 1
nix build gitlab:abstract-binary/nix-nar-rs/c8d9250b9be837abafa0046cb9c2a852b846da6a -o nix-nar >& /dev/null || exit 1

git clone https://github.com/torvalds/linux --depth=1 -q
cd linux
git log | head
commit d127176862a93c4b3216bda533d2bee170af5e71
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Oct 30 19:48:13 2025 -0700

    Merge tag 'linux_kselftest-fixes-6.18-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/shuah/linux-kselftest
    
    Pull kselftest fixes from Shuah Khan:
     "Fix build warning in cachestat found during clang build and add
      tmpshmcstat to .gitignore"
    
cd ..

nix nar pack linux > linux.nar

cmp <(./nix/bin/nix nar pack linux) <(./lix/bin/nix nar dump-path linux)
cmp <(./nix/bin/nix nar pack linux) <(./narser/bin/narser pack linux) || exit 1
cmp <(./nix/bin/nix nar pack linux) <(./nix-nar/bin/nix-nar dump-path linux)

cmp <(./nix/bin/nix nar cat linux.nar /README) <(./lix/bin/nix nar cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narser/bin/narser cat linux.nar /README) || exit 1
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narz/bin/narz cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./nix-nar/bin/nix-nar cat linux.nar /README)

cmp <(./nix/bin/nix nar ls linux.nar /) <(./lix/bin/nix nar ls linux.nar /)
cmp <(./nix/bin/nix nar ls linux.nar /) <(./narser/bin/narser ls linux.nar /) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / 2> /dev/null) <(./narz/bin/narz ls linux.nar / 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar /) <(./nix-nar/bin/nix-nar ls linux.nar /)

cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./lix/bin/nix nar ls linux.nar / -l)
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./narser/bin/narser ls linux.nar / -l) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -l 2> /dev/null) <(./narz/bin/narz ls linux.nar / -l 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./nix-nar/bin/nix-nar ls linux.nar / -l)

cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./lix/bin/nix nar ls linux.nar / -lR)
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./narser/bin/narser ls linux.nar / -lR) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR 2> /dev/null) <(./narz/bin/narz ls linux.nar / -lr 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 3, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./nix-nar/bin/nix-nar ls linux.nar / -lR)

cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./lix/bin/nix nar ls linux.nar / -R)
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./narser/bin/narser ls linux.nar / -R) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -R 2> /dev/null) <(./narz/bin/narz ls linux.nar / -r 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 2, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./nix-nar/bin/nix-nar ls linux.nar / -R)


poop -d 60000 "./nix/bin/nix nar pack linux" "./lix/bin/nix nar dump-path linux" "./narser/bin/narser pack linux" "./nix-nar/bin/nix-nar dump-path linux"
Benchmark 1 (32 runs): ./nix/bin/nix nar pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.90s  Â± 51.5ms                              1.84s  â€¦ 1.99s                                     0 ( 0%)        0%
  peak_rss           37.4MB Â±  109KB                              37.2MB â€¦ 37.7MB                                    2 ( 6%)        0%
  cpu_cycles         3.54G  Â±  183M                               3.37G  â€¦ 3.82G                                     0 ( 0%)        0%
  instructions       7.42G  Â±  171K                               7.42G  â€¦ 7.42G                                     0 ( 0%)        0%
  cache_references   53.3M  Â± 3.43M                               47.3M  â€¦ 62.2M                                     0 ( 0%)        0%
  cache_misses       4.34M  Â± 45.1K                               4.27M  â€¦ 4.49M                                     1 ( 3%)        0%
  branch_misses      12.1M  Â± 4.27M                               8.04M  â€¦ 19.1M                                     0 ( 0%)        0%
Benchmark 2 (53 runs): ./lix/bin/nix nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.15s  Â± 16.9ms                              1.13s  â€¦ 1.20s                                     0 ( 0%)        âš¡- 39.3% Â±  0.8%
  peak_rss           33.6MB Â±  156KB                              33.2MB â€¦ 33.9MB                                    1 ( 2%)        âš¡- 10.3% Â±  0.2%
  cpu_cycles         1.38G  Â± 49.4M                               1.32G  â€¦ 1.51G                                     0 ( 0%)        âš¡- 61.0% Â±  1.5%
  instructions       1.84G  Â± 9.14K                               1.84G  â€¦ 1.84G                                     0 ( 0%)        âš¡- 75.2% Â±  0.0%
  cache_references   85.7M  Â± 4.42M                               77.7M  â€¦ 96.8M                                     0 ( 0%)        ðŸ’©+ 60.8% Â±  3.4%
  cache_misses        764K  Â± 29.3K                                736K  â€¦  916K                                     3 ( 6%)        âš¡- 82.4% Â±  0.4%
  branch_misses      4.22M  Â±  978K                               3.14M  â€¦ 6.93M                                     0 ( 0%)        âš¡- 65.0% Â± 10.1%
Benchmark 3 (82 runs): ./narser/bin/narser pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           734ms Â± 3.53ms                               727ms â€¦  740ms                                    0 ( 0%)        âš¡- 61.4% Â±  0.6%
  peak_rss           1.25MB Â± 65.9KB                              1.18MB â€¦ 1.31MB                                    0 ( 0%)        âš¡- 96.7% Â±  0.1%
  cpu_cycles          236M  Â± 2.04M                                232M  â€¦  243M                                     1 ( 1%)        âš¡- 93.3% Â±  1.1%
  instructions        432M  Â± 18.1                                 432M  â€¦  432M                                     1 ( 1%)        âš¡- 94.2% Â±  0.0%
  cache_references   6.42M  Â±  734K                               5.17M  â€¦ 9.73M                                     3 ( 4%)        âš¡- 87.9% Â±  1.5%
  cache_misses        173K  Â± 9.50K                                141K  â€¦  193K                                     1 ( 1%)        âš¡- 96.0% Â±  0.2%
  branch_misses       733K  Â± 5.75K                                724K  â€¦  751K                                     1 ( 1%)        âš¡- 93.9% Â±  7.7%
Benchmark 4 (39 runs): ./nix-nar/bin/nix-nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.54s  Â± 7.77ms                              1.53s  â€¦ 1.56s                                     0 ( 0%)        âš¡- 18.8% Â±  0.9%
  peak_rss           2.92MB Â± 65.7KB                              2.74MB â€¦ 3.04MB                                    0 ( 0%)        âš¡- 92.2% Â±  0.1%
  cpu_cycles          553M  Â± 10.0M                                531M  â€¦  580M                                     2 ( 5%)        âš¡- 84.4% Â±  1.7%
  instructions        834M  Â±  241K                                833M  â€¦  835M                                     1 ( 3%)        âš¡- 88.8% Â±  0.0%
  cache_references   10.8M  Â±  678K                               9.76M  â€¦ 12.8M                                     1 ( 3%)        âš¡- 79.7% Â±  2.1%
  cache_misses        387K  Â± 21.2K                                344K  â€¦  428K                                     0 ( 0%)        âš¡- 91.1% Â±  0.4%
  branch_misses      2.79M  Â±  148K                               2.52M  â€¦ 3.12M                                     0 ( 0%)        âš¡- 76.8% Â± 11.3%

poop -d 60000 "./nix/bin/nix nar ls linux.nar /" "./lix/bin/nix nar ls linux.nar /" "./narser/bin/narser ls linux.nar /" "./nix-nar/bin/nix-nar ls linux.nar /" "./narz/bin/narz ls linux.nar /"
Benchmark 1 (85 runs): ./nix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           706ms Â± 13.8ms                               690ms â€¦  741ms                                    0 ( 0%)        0%
  peak_rss            141MB Â±  111KB                               140MB â€¦  141MB                                    1 ( 1%)        0%
  cpu_cycles         1.54G  Â± 45.2M                               1.49G  â€¦ 1.65G                                     0 ( 0%)        0%
  instructions       2.60G  Â±  875K                               2.60G  â€¦ 2.61G                                     0 ( 0%)        0%
  cache_references   38.9M  Â± 2.63M                               35.3M  â€¦ 47.8M                                     1 ( 1%)        0%
  cache_misses       13.3M  Â± 71.9K                               13.1M  â€¦ 13.5M                                     0 ( 0%)        0%
  branch_misses      6.68M  Â± 1.04M                               5.71M  â€¦ 9.07M                                     0 ( 0%)        0%
Benchmark 2 (24 runs): ./lix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.59s  Â± 11.0ms                              2.57s  â€¦ 2.61s                                     0 ( 0%)        ðŸ’©+267.0% Â±  0.9%
  peak_rss           3.75GB Â±  126KB                              3.75GB â€¦ 3.75GB                                    0 ( 0%)        ðŸ’©+2565.1% Â±  0.0%
  cpu_cycles         2.92G  Â± 24.6M                               2.89G  â€¦ 2.98G                                     0 ( 0%)        ðŸ’©+ 89.7% Â±  1.2%
  instructions       2.18G  Â± 6.96K                               2.18G  â€¦ 2.18G                                     0 ( 0%)        âš¡- 16.3% Â±  0.0%
  cache_references    129M  Â± 3.11M                                127M  â€¦  140M                                     3 (13%)        ðŸ’©+232.6% Â±  3.2%
  cache_misses       70.6M  Â±  139K                               70.4M  â€¦ 70.9M                                     0 ( 0%)        ðŸ’©+432.4% Â±  0.3%
  branch_misses      4.22M  Â±  478K                               3.77M  â€¦ 5.83M                                     1 ( 4%)        âš¡- 36.8% Â±  6.5%
Benchmark 3 (589 runs): ./narser/bin/narser ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           102ms Â± 1.22ms                               101ms â€¦  109ms                                   57 (10%)        âš¡- 85.6% Â±  0.2%
  peak_rss           33.4MB Â± 7.63KB                              33.3MB â€¦ 33.4MB                                    2 ( 0%)        âš¡- 76.3% Â±  0.0%
  cpu_cycles         63.7M  Â±  665K                               63.0M  â€¦ 69.7M                                    34 ( 6%)        âš¡- 95.9% Â±  0.2%
  instructions        121M  Â± 6.19                                 121M  â€¦  121M                                    32 ( 5%)        âš¡- 95.3% Â±  0.0%
  cache_references   1.13M  Â± 32.7K                               1.03M  â€¦ 1.22M                                     5 ( 1%)        âš¡- 97.1% Â±  0.5%
  cache_misses       15.9K  Â± 1.37K                               12.9K  â€¦ 22.0K                                    43 ( 7%)        âš¡- 99.9% Â±  0.0%
  branch_misses       396K  Â± 5.31K                                392K  â€¦  463K                                    69 (12%)        âš¡- 94.1% Â±  1.3%
Benchmark 4 (116 runs): ./nix-nar/bin/nix-nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           518ms Â± 3.74ms                               513ms â€¦  532ms                                    1 ( 1%)        âš¡- 26.6% Â±  0.4%
  peak_rss           2.39MB Â± 63.8KB                              2.28MB â€¦ 2.56MB                                    0 ( 0%)        âš¡- 98.3% Â±  0.0%
  cpu_cycles          946M  Â± 10.1M                                934M  â€¦ 1000M                                     4 ( 3%)        âš¡- 38.5% Â±  0.6%
  instructions       1.52G  Â± 79.2K                               1.52G  â€¦ 1.52G                                     0 ( 0%)        âš¡- 41.8% Â±  0.0%
  cache_references   9.00M  Â± 3.43M                               4.14M  â€¦ 21.9M                                     5 ( 4%)        âš¡- 76.8% Â±  2.2%
  cache_misses       56.4K  Â± 8.08K                               44.5K  â€¦ 76.1K                                     0 ( 0%)        âš¡- 99.6% Â±  0.1%
  branch_misses      1.16M  Â±  157K                                982K  â€¦ 1.66M                                     2 ( 2%)        âš¡- 82.7% Â±  2.9%
Benchmark 5 (17 runs): ./narz/bin/narz ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.65s  Â± 14.7ms                              3.63s  â€¦ 3.67s                                     0 ( 0%)        ðŸ’©+416.9% Â±  1.0%
  peak_rss           1.85GB Â± 81.8KB                              1.85GB â€¦ 1.85GB                                    0 ( 0%)        ðŸ’©+1210.8% Â±  0.0%
  cpu_cycles          878M  Â± 3.52M                                873M  â€¦  885M                                     0 ( 0%)        âš¡- 42.9% Â±  1.4%
  instructions        870M  Â±  153                                 870M  â€¦  870M                                     0 ( 0%)        âš¡- 66.6% Â±  0.0%
  cache_references   4.34M  Â±  178K                               4.14M  â€¦ 4.78M                                     1 ( 6%)        âš¡- 88.8% Â±  3.3%
  cache_misses        116K  Â± 5.00K                                109K  â€¦  126K                                     0 ( 0%)        âš¡- 99.1% Â±  0.3%
  branch_misses      1.73M  Â± 59.2K                               1.64M  â€¦ 1.83M                                     0 ( 0%)        âš¡- 74.1% Â±  7.6%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -R" "./lix/bin/nix nar ls linux.nar / -R" "./narser/bin/narser ls linux.nar / -R" "./nix-nar/bin/nix-nar ls linux.nar / -R" "./narz/bin/narz ls linux.nar / -r"
Benchmark 1 (65 runs): ./nix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           936ms Â± 18.8ms                               913ms â€¦  975ms                                    0 ( 0%)        0%
  peak_rss            141MB Â±  114KB                               141MB â€¦  141MB                                    0 ( 0%)        0%
  cpu_cycles         1.93G  Â± 63.3M                               1.88G  â€¦ 2.06G                                     0 ( 0%)        0%
  instructions       3.31G  Â±  946K                               3.31G  â€¦ 3.32G                                     3 ( 5%)        0%
  cache_references   48.6M  Â± 2.47M                               45.3M  â€¦ 55.8M                                     3 ( 5%)        0%
  cache_misses       15.8M  Â±  101K                               15.7M  â€¦ 16.1M                                     0 ( 0%)        0%
  branch_misses      9.14M  Â± 1.54M                               7.87M  â€¦ 12.3M                                     0 ( 0%)        0%
Benchmark 2 (22 runs): ./lix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.85s  Â± 15.3ms                              2.83s  â€¦ 2.88s                                     0 ( 0%)        ðŸ’©+204.7% Â±  0.9%
  peak_rss           3.75GB Â± 99.2KB                              3.75GB â€¦ 3.75GB                                    0 ( 0%)        ðŸ’©+2565.9% Â±  0.0%
  cpu_cycles         3.41G  Â± 45.4M                               3.36G  â€¦ 3.49G                                     0 ( 0%)        ðŸ’©+ 76.5% Â±  1.5%
  instructions       3.03G  Â±  725K                               3.03G  â€¦ 3.03G                                     1 ( 5%)        âš¡-  8.5% Â±  0.0%
  cache_references    130M  Â± 2.52M                                128M  â€¦  139M                                     1 ( 5%)        ðŸ’©+167.9% Â±  2.5%
  cache_misses       71.3M  Â±  174K                               70.9M  â€¦ 71.7M                                     1 ( 5%)        ðŸ’©+350.2% Â±  0.4%
  branch_misses      6.39M  Â±  895K                               5.42M  â€¦ 7.88M                                     0 ( 0%)        âš¡- 30.1% Â±  7.6%
Benchmark 3 (475 runs): ./narser/bin/narser ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           126ms Â± 2.26ms                               124ms â€¦  143ms                                   47 (10%)        âš¡- 86.5% Â±  0.2%
  peak_rss           33.4MB Â± 10.4KB                              33.3MB â€¦ 33.4MB                                    3 ( 1%)        âš¡- 76.3% Â±  0.0%
  cpu_cycles          147M  Â± 3.79M                                143M  â€¦  163M                                   135 (28%)        âš¡- 92.4% Â±  0.3%
  instructions        303M  Â± 7.97                                 303M  â€¦  303M                                    23 ( 5%)        âš¡- 90.8% Â±  0.0%
  cache_references   2.23M  Â± 35.8K                               2.15M  â€¦ 2.41M                                     9 ( 2%)        âš¡- 95.4% Â±  0.5%
  cache_misses        899K  Â± 11.9K                                854K  â€¦  958K                                    50 (11%)        âš¡- 94.3% Â±  0.1%
  branch_misses       555K  Â± 9.90K                                548K  â€¦  646K                                    78 (16%)        âš¡- 93.9% Â±  1.5%
Benchmark 4 (94 runs): ./nix-nar/bin/nix-nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           641ms Â± 5.05ms                               631ms â€¦  664ms                                    3 ( 3%)        âš¡- 31.5% Â±  0.4%
  peak_rss           14.0MB Â± 72.1KB                              13.8MB â€¦ 14.2MB                                    2 ( 2%)        âš¡- 90.0% Â±  0.0%
  cpu_cycles         1.14G  Â± 13.4M                               1.12G  â€¦ 1.19G                                     4 ( 4%)        âš¡- 40.9% Â±  0.7%
  instructions       1.96G  Â± 77.6K                               1.96G  â€¦ 1.96G                                     0 ( 0%)        âš¡- 40.7% Â±  0.0%
  cache_references   13.3M  Â± 3.78M                               8.75M  â€¦ 28.2M                                     6 ( 6%)        âš¡- 72.6% Â±  2.2%
  cache_misses        177K  Â± 9.66K                                159K  â€¦  204K                                     1 ( 1%)        âš¡- 98.9% Â±  0.1%
  branch_misses      1.84M  Â±  266K                               1.48M  â€¦ 2.64M                                     1 ( 1%)        âš¡- 79.9% Â±  3.5%
Benchmark 5 (16 runs): ./narz/bin/narz ls linux.nar / -r
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.86s  Â± 9.46ms                              3.84s  â€¦ 3.87s                                     0 ( 0%)        ðŸ’©+311.9% Â±  1.0%
  peak_rss           1.85GB Â± 62.4KB                              1.85GB â€¦ 1.85GB                                    4 (25%)        ðŸ’©+1211.6% Â±  0.0%
  cpu_cycles          969M  Â± 3.22M                                964M  â€¦  976M                                     0 ( 0%)        âš¡- 49.9% Â±  1.6%
  instructions        951M  Â±  177                                 951M  â€¦  951M                                     0 ( 0%)        âš¡- 71.3% Â±  0.0%
  cache_references   5.84M  Â±  356K                               5.41M  â€¦ 6.35M                                     0 ( 0%)        âš¡- 88.0% Â±  2.5%
  cache_misses        868K  Â± 5.02K                                860K  â€¦  876K                                     0 ( 0%)        âš¡- 94.5% Â±  0.3%
  branch_misses      2.10M  Â± 45.0K                               2.02M  â€¦ 2.16M                                     0 ( 0%)        âš¡- 77.1% Â±  8.5%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -Rl" "./lix/bin/nix nar ls linux.nar / -Rl" "./narser/bin/narser ls linux.nar / -Rl" "./nix-nar/bin/nix-nar ls linux.nar / -Rl" "./narz/bin/narz ls linux.nar / -rl"
Benchmark 1 (59 runs): ./nix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.02s  Â± 22.1ms                               997ms â€¦ 1.08s                                     9 (15%)        0%
  peak_rss            141MB Â±  123KB                               141MB â€¦  141MB                                    0 ( 0%)        0%
  cpu_cycles         2.23G  Â± 71.4M                               2.16G  â€¦ 2.40G                                    12 (20%)        0%
  instructions       4.01G  Â±  827K                               4.01G  â€¦ 4.01G                                     1 ( 2%)        0%
  cache_references   48.5M  Â± 2.45M                               45.7M  â€¦ 56.1M                                     8 (14%)        0%
  cache_misses       16.0M  Â±  107K                               15.8M  â€¦ 16.2M                                     0 ( 0%)        0%
  branch_misses      9.46M  Â± 1.65M                               8.30M  â€¦ 13.3M                                    12 (20%)        0%
Benchmark 2 (21 runs): ./lix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.97s  Â± 16.7ms                              2.94s  â€¦ 3.00s                                     0 ( 0%)        ðŸ’©+191.2% Â±  1.0%
  peak_rss           3.75GB Â±  131KB                              3.75GB â€¦ 3.75GB                                    1 ( 5%)        ðŸ’©+2565.5% Â±  0.0%
  cpu_cycles         3.81G  Â± 50.4M                               3.74G  â€¦ 3.91G                                     0 ( 0%)        ðŸ’©+ 71.3% Â±  1.5%
  instructions       3.92G  Â±  614K                               3.92G  â€¦ 3.92G                                     1 ( 5%)        âš¡-  2.2% Â±  0.0%
  cache_references    131M  Â±  720K                                129M  â€¦  132M                                     0 ( 0%)        ðŸ’©+169.5% Â±  2.2%
  cache_misses       71.5M  Â±  199K                               71.1M  â€¦ 71.9M                                     4 (19%)        ðŸ’©+347.9% Â±  0.4%
  branch_misses      7.14M  Â± 1.03M                               5.88M  â€¦ 9.40M                                     0 ( 0%)        âš¡- 24.5% Â±  8.1%
Benchmark 3 (463 runs): ./narser/bin/narser ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           130ms Â± 1.93ms                               128ms â€¦  145ms                                   72 (16%)        âš¡- 87.3% Â±  0.2%
  peak_rss           33.4MB Â± 13.6KB                              33.3MB â€¦ 33.4MB                                    5 ( 1%)        âš¡- 76.3% Â±  0.0%
  cpu_cycles          160M  Â± 3.41M                                156M  â€¦  175M                                   106 (23%)        âš¡- 92.8% Â±  0.3%
  instructions        346M  Â± 7.71                                 346M  â€¦  346M                                    24 ( 5%)        âš¡- 91.4% Â±  0.0%
  cache_references   2.34M  Â± 42.4K                               2.23M  â€¦ 2.50M                                     4 ( 1%)        âš¡- 95.2% Â±  0.5%
  cache_misses        909K  Â± 14.8K                                850K  â€¦  978K                                    43 ( 9%)        âš¡- 94.3% Â±  0.1%
  branch_misses       599K  Â± 6.30K                                594K  â€¦  639K                                    71 (15%)        âš¡- 93.7% Â±  1.6%
Benchmark 4 (91 runs): ./nix-nar/bin/nix-nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           664ms Â± 4.44ms                               659ms â€¦  687ms                                    5 ( 5%)        âš¡- 34.9% Â±  0.5%
  peak_rss           14.0MB Â± 84.3KB                              13.8MB â€¦ 14.2MB                                    1 ( 1%)        âš¡- 90.0% Â±  0.0%
  cpu_cycles         1.23G  Â± 11.9M                               1.22G  â€¦ 1.31G                                     6 ( 7%)        âš¡- 44.6% Â±  0.7%
  instructions       2.23G  Â± 87.5K                               2.23G  â€¦ 2.23G                                     1 ( 1%)        âš¡- 44.4% Â±  0.0%
  cache_references   12.8M  Â± 3.17M                               8.80M  â€¦ 27.2M                                     7 ( 8%)        âš¡- 73.6% Â±  2.0%
  cache_misses        294K  Â± 8.69K                                274K  â€¦  311K                                     0 ( 0%)        âš¡- 98.2% Â±  0.1%
  branch_misses      1.77M  Â±  152K                               1.59M  â€¦ 2.62M                                     4 ( 4%)        âš¡- 81.3% Â±  3.6%
Benchmark 5 (12 runs): ./narz/bin/narz ls linux.nar / -rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          5.03s  Â± 6.24ms                              5.02s  â€¦ 5.04s                                     0 ( 0%)        ðŸ’©+393.2% Â±  1.3%
  peak_rss           1.85GB Â± 61.9KB                              1.85GB â€¦ 1.85GB                                    4 (33%)        ðŸ’©+1211.4% Â±  0.1%
  cpu_cycles         1.14G  Â± 4.49M                               1.14G  â€¦ 1.15G                                     1 ( 8%)        âš¡- 48.6% Â±  1.9%
  instructions       1.12G  Â±  171                                1.12G  â€¦ 1.12G                                     1 ( 8%)        âš¡- 72.1% Â±  0.0%
  cache_references   5.85M  Â±  209K                               5.58M  â€¦ 6.13M                                     0 ( 0%)        âš¡- 87.9% Â±  2.9%
  cache_misses        863K  Â± 4.61K                                853K  â€¦  871K                                     1 ( 8%)        âš¡- 94.6% Â±  0.4%
  branch_misses      2.35M  Â± 51.1K                               2.25M  â€¦ 2.42M                                     2 (17%)        âš¡- 75.2% Â± 10.1%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -l" "./lix/bin/nix nar ls linux.nar / -l" "./narser/bin/narser ls linux.nar / -l" "./nix-nar/bin/nix-nar ls linux.nar / -l" "./narz/bin/narz ls linux.nar / -l"
Benchmark 1 (86 runs): ./nix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           704ms Â± 12.9ms                               690ms â€¦  732ms                                    0 ( 0%)        0%
  peak_rss            141MB Â±  105KB                               141MB â€¦  141MB                                    1 ( 1%)        0%
  cpu_cycles         1.53G  Â± 42.5M                               1.50G  â€¦ 1.63G                                     0 ( 0%)        0%
  instructions       2.60G  Â±  820K                               2.60G  â€¦ 2.60G                                     0 ( 0%)        0%
  cache_references   39.3M  Â± 2.56M                               35.1M  â€¦ 47.3M                                     2 ( 2%)        0%
  cache_misses       13.3M  Â± 83.2K                               13.1M  â€¦ 13.6M                                     2 ( 2%)        0%
  branch_misses      6.51M  Â± 1.00M                               5.69M  â€¦ 8.80M                                     0 ( 0%)        0%
Benchmark 2 (24 runs): ./lix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.58s  Â± 9.28ms                              2.57s  â€¦ 2.60s                                     0 ( 0%)        ðŸ’©+267.0% Â±  0.8%
  peak_rss           3.75GB Â±  125KB                              3.75GB â€¦ 3.75GB                                    0 ( 0%)        ðŸ’©+2565.2% Â±  0.0%
  cpu_cycles         2.91G  Â± 15.1M                               2.89G  â€¦ 2.94G                                     0 ( 0%)        ðŸ’©+ 89.5% Â±  1.1%
  instructions       2.18G  Â± 7.18K                               2.18G  â€¦ 2.18G                                     0 ( 0%)        âš¡- 16.3% Â±  0.0%
  cache_references    129M  Â± 4.27M                                126M  â€¦  147M                                     2 ( 8%)        ðŸ’©+228.6% Â±  3.5%
  cache_misses       70.7M  Â±  165K                               70.4M  â€¦ 71.0M                                     0 ( 0%)        ðŸ’©+431.7% Â±  0.4%
  branch_misses      4.10M  Â±  343K                               3.72M  â€¦ 4.85M                                     0 ( 0%)        âš¡- 37.1% Â±  6.4%
Benchmark 3 (592 runs): ./narser/bin/narser ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           101ms Â± 1.12ms                               101ms â€¦  119ms                                   38 ( 6%)        âš¡- 85.6% Â±  0.2%
  peak_rss           33.4MB Â±    0                                33.4MB â€¦ 33.4MB                                    0 ( 0%)        âš¡- 76.3% Â±  0.0%
  cpu_cycles         63.6M  Â±  641K                               63.0M  â€¦ 69.6M                                    41 ( 7%)        âš¡- 95.9% Â±  0.2%
  instructions        121M  Â± 4.71                                 121M  â€¦  121M                                     5 ( 1%)        âš¡- 95.3% Â±  0.0%
  cache_references   1.11M  Â± 31.2K                               1.03M  â€¦ 1.24M                                    12 ( 2%)        âš¡- 97.2% Â±  0.5%
  cache_misses       16.1K  Â± 1.51K                               12.6K  â€¦ 22.2K                                    49 ( 8%)        âš¡- 99.9% Â±  0.1%
  branch_misses       395K  Â± 4.08K                                392K  â€¦  441K                                    62 (10%)        âš¡- 93.9% Â±  1.2%
Benchmark 4 (117 runs): ./nix-nar/bin/nix-nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           516ms Â± 4.25ms                               512ms â€¦  539ms                                    8 ( 7%)        âš¡- 26.8% Â±  0.4%
  peak_rss           2.40MB Â± 60.5KB                              2.28MB â€¦ 2.56MB                                    0 ( 0%)        âš¡- 98.3% Â±  0.0%
  cpu_cycles          942M  Â± 10.6M                                934M  â€¦ 1.00G                                     8 ( 7%)        âš¡- 38.6% Â±  0.5%
  instructions       1.52G  Â± 77.2K                               1.52G  â€¦ 1.52G                                     0 ( 0%)        âš¡- 41.8% Â±  0.0%
  cache_references   8.30M  Â± 2.54M                               4.49M  â€¦ 15.6M                                     2 ( 2%)        âš¡- 78.9% Â±  1.8%
  cache_misses       55.9K  Â± 7.48K                               43.8K  â€¦ 72.3K                                     0 ( 0%)        âš¡- 99.6% Â±  0.1%
  branch_misses      1.06M  Â±  138K                                957K  â€¦ 1.81M                                     9 ( 8%)        âš¡- 83.7% Â±  2.8%
Benchmark 5 (17 runs): ./narz/bin/narz ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.64s  Â± 9.00ms                              3.63s  â€¦ 3.67s                                     1 ( 6%)        ðŸ’©+417.3% Â±  0.9%
  peak_rss           1.85GB Â± 66.5KB                              1.85GB â€¦ 1.85GB                                    0 ( 0%)        ðŸ’©+1210.9% Â±  0.0%
  cpu_cycles          877M  Â± 3.21M                                871M  â€¦  886M                                     2 (12%)        âš¡- 42.8% Â±  1.3%
  instructions        870M  Â±  221                                 870M  â€¦  870M                                     0 ( 0%)        âš¡- 66.6% Â±  0.0%
  cache_references   4.37M  Â±  231K                               4.02M  â€¦ 4.91M                                     4 (24%)        âš¡- 88.9% Â±  3.2%
  cache_misses        116K  Â± 4.48K                                107K  â€¦  125K                                     1 ( 6%)        âš¡- 99.1% Â±  0.3%
  branch_misses      1.69M  Â± 34.9K                               1.64M  â€¦ 1.74M                                     0 ( 0%)        âš¡- 74.0% Â±  7.5%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /README" "./lix/bin/nix nar cat linux.nar /README" "./narser/bin/narser cat linux.nar /README" "./narser/bin/narser cat linux.nar /README -L" "./nix-nar/bin/nix-nar cat linux.nar /README " "./narz/bin/narz cat linux.nar /README"
Benchmark 1 (89 runs): ./nix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           678ms Â± 9.61ms                               663ms â€¦  707ms                                    2 ( 2%)        0%
  peak_rss            122MB Â±  183KB                               121MB â€¦  122MB                                    0 ( 0%)        0%
  cpu_cycles         1.47G  Â± 32.3M                               1.44G  â€¦ 1.57G                                     7 ( 8%)        0%
  instructions       2.53G  Â±  697K                               2.53G  â€¦ 2.53G                                     7 ( 8%)        0%
  cache_references   37.0M  Â± 2.59M                               33.5M  â€¦ 46.4M                                     1 ( 1%)        0%
  cache_misses       12.0M  Â± 78.7K                               11.9M  â€¦ 12.2M                                     0 ( 0%)        0%
  branch_misses      6.11M  Â±  755K                               5.51M  â€¦ 8.30M                                    14 (16%)        0%
Benchmark 2 (24 runs): ./lix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.60s  Â± 11.0ms                              2.58s  â€¦ 2.62s                                     0 ( 0%)        ðŸ’©+283.5% Â±  0.7%
  peak_rss           3.75GB Â±  119KB                              3.75GB â€¦ 3.75GB                                    0 ( 0%)        ðŸ’©+2983.6% Â±  0.1%
  cpu_cycles         2.95G  Â± 28.9M                               2.92G  â€¦ 3.03G                                     1 ( 4%)        ðŸ’©+100.2% Â±  1.0%
  instructions       2.19G  Â± 9.80K                               2.19G  â€¦ 2.19G                                     0 ( 0%)        âš¡- 13.5% Â±  0.0%
  cache_references    128M  Â± 2.96M                                126M  â€¦  141M                                     3 (13%)        ðŸ’©+244.7% Â±  3.3%
  cache_misses       70.7M  Â±  175K                               70.4M  â€¦ 71.0M                                     0 ( 0%)        ðŸ’©+487.3% Â±  0.4%
  branch_misses      4.27M  Â±  502K                               3.79M  â€¦ 5.63M                                     1 ( 4%)        âš¡- 30.2% Â±  5.3%
Benchmark 3 (7235 runs): ./narser/bin/narser cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          8.25ms Â±  382us                              8.09ms â€¦ 16.6ms                                  463 ( 6%)        âš¡- 98.8% Â±  0.0%
  peak_rss           1.05MB Â±    0                                1.05MB â€¦ 1.05MB                                    0 ( 0%)        âš¡- 99.1% Â±  0.0%
  cpu_cycles         5.52M  Â±  222K                               5.43M  â€¦ 9.38M                                   508 ( 7%)        âš¡- 99.6% Â±  0.1%
  instructions       11.0M  Â± 1.82                                11.0M  â€¦ 11.0M                                    56 ( 1%)        âš¡- 99.6% Â±  0.0%
  cache_references   23.8K  Â± 2.49K                               17.3K  â€¦ 56.8K                                   407 ( 6%)        âš¡- 99.9% Â±  0.2%
  cache_misses       1.15K  Â±  234                                 811   â€¦ 3.91K                                   232 ( 3%)        âš¡-100.0% Â±  0.0%
  branch_misses      49.7K  Â± 1.83K                               48.4K  â€¦ 72.2K                                   810 (11%)        âš¡- 99.2% Â±  0.3%
Benchmark 4 (61 runs): ./narser/bin/narser cat linux.nar /README -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           997ms Â± 6.19ms                               986ms â€¦ 1.02s                                     3 ( 5%)        ðŸ’©+ 47.0% Â±  0.4%
  peak_rss           1.88GB Â± 65.0KB                              1.88GB â€¦ 1.88GB                                    0 ( 0%)        ðŸ’©+1447.7% Â±  0.0%
  cpu_cycles          197M  Â± 1.56M                                193M  â€¦  201M                                     1 ( 2%)        âš¡- 86.7% Â±  0.6%
  instructions        238M  Â± 9.72                                 238M  â€¦  238M                                     0 ( 0%)        âš¡- 90.6% Â±  0.0%
  cache_references   6.29M  Â±  417K                               5.70M  â€¦ 7.33M                                     6 (10%)        âš¡- 83.0% Â±  1.8%
  cache_misses        251K  Â± 11.3K                                227K  â€¦  281K                                     0 ( 0%)        âš¡- 97.9% Â±  0.2%
  branch_misses       616K  Â± 12.5K                                598K  â€¦  649K                                     0 ( 0%)        âš¡- 89.9% Â±  3.1%
Benchmark 5 (774 runs): ./nix-nar/bin/nix-nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          77.5ms Â± 1.69ms                              76.2ms â€¦ 96.5ms                                  108 (14%)        âš¡- 88.6% Â±  0.1%
  peak_rss           2.40MB Â± 59.3KB                              2.27MB â€¦ 2.55MB                                    0 ( 0%)        âš¡- 98.0% Â±  0.0%
  cpu_cycles          115M  Â± 2.89M                                113M  â€¦  151M                                    60 ( 8%)        âš¡- 92.2% Â±  0.2%
  instructions        166M  Â± 9.94K                                166M  â€¦  166M                                     0 ( 0%)        âš¡- 93.5% Â±  0.0%
  cache_references   1.30M  Â±  407K                                538K  â€¦ 3.26M                                    15 ( 2%)        âš¡- 96.5% Â±  0.5%
  cache_misses       21.3K  Â± 2.28K                               18.3K  â€¦ 34.0K                                    67 ( 9%)        âš¡- 99.8% Â±  0.0%
  branch_misses       125K  Â± 63.7K                                105K  â€¦  748K                                    68 ( 9%)        âš¡- 98.0% Â±  0.9%
Benchmark 6 (17 runs): ./narz/bin/narz cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.65s  Â± 6.02ms                              3.64s  â€¦ 3.66s                                     0 ( 0%)        ðŸ’©+438.2% Â±  0.7%
  peak_rss           1.85GB Â± 67.4KB                              1.85GB â€¦ 1.85GB                                    0 ( 0%)        ðŸ’©+1416.4% Â±  0.1%
  cpu_cycles          878M  Â± 2.24M                                873M  â€¦  882M                                     0 ( 0%)        âš¡- 40.5% Â±  1.1%
  instructions        870M  Â± 10.2K                                870M  â€¦  870M                                     0 ( 0%)        âš¡- 65.6% Â±  0.0%
  cache_references   4.38M  Â±  218K                               4.22M  â€¦ 5.12M                                     1 ( 6%)        âš¡- 88.2% Â±  3.4%
  cache_misses        118K  Â± 4.02K                                111K  â€¦  125K                                     0 ( 0%)        âš¡- 99.0% Â±  0.3%
  branch_misses      1.70M  Â± 27.7K                               1.65M  â€¦ 1.74M                                     0 ( 0%)        âš¡- 72.2% Â±  6.0%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L" "./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c " "./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c"
Benchmark 1 (88 runs): ./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           684ms Â± 13.1ms                               664ms â€¦  711ms                                    0 ( 0%)        0%
  peak_rss            122MB Â±  171KB                               121MB â€¦  122MB                                    0 ( 0%)        0%
  cpu_cycles         1.49G  Â± 42.7M                               1.44G  â€¦ 1.59G                                     0 ( 0%)        0%
  instructions       2.53G  Â±  694K                               2.53G  â€¦ 2.53G                                     3 ( 3%)        0%
  cache_references   39.6M  Â± 4.63M                               33.7M  â€¦ 60.0M                                     6 ( 7%)        0%
  cache_misses       12.1M  Â± 96.3K                               11.9M  â€¦ 12.4M                                     0 ( 0%)        0%
  branch_misses      6.48M  Â±  995K                               5.49M  â€¦ 8.50M                                     0 ( 0%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.61s  Â± 10.6ms                              2.59s  â€¦ 2.64s                                     0 ( 0%)        ðŸ’©+282.1% Â±  0.9%
  peak_rss           3.75GB Â±  134KB                              3.75GB â€¦ 3.75GB                                    0 ( 0%)        ðŸ’©+2984.4% Â±  0.1%
  cpu_cycles         2.99G  Â± 21.3M                               2.96G  â€¦ 3.05G                                     0 ( 0%)        ðŸ’©+100.5% Â±  1.2%
  instructions       2.21G  Â± 7.96K                               2.21G  â€¦ 2.21G                                     0 ( 0%)        âš¡- 12.7% Â±  0.0%
  cache_references    130M  Â± 6.12M                                127M  â€¦  157M                                     2 ( 9%)        ðŸ’©+227.7% Â±  5.8%
  cache_misses       71.7M  Â±  138K                               71.5M  â€¦ 72.0M                                     0 ( 0%)        ðŸ’©+492.5% Â±  0.4%
  branch_misses      4.43M  Â±  518K                               3.83M  â€¦ 5.89M                                     0 ( 0%)        âš¡- 31.6% Â±  6.6%
Benchmark 3 (740 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          81.1ms Â±  525us                              80.6ms â€¦ 86.0ms                                   13 ( 2%)        âš¡- 88.1% Â±  0.1%
  peak_rss           1.04MB Â±    0                                1.04MB â€¦ 1.04MB                                    0 ( 0%)        âš¡- 99.1% Â±  0.0%
  cpu_cycles         45.6M  Â±  476K                               45.2M  â€¦ 48.8M                                    90 (12%)        âš¡- 96.9% Â±  0.2%
  instructions       94.4M  Â± 4.36                                94.4M  â€¦ 94.4M                                     8 ( 1%)        âš¡- 96.3% Â±  0.0%
  cache_references    136K  Â± 19.4K                               87.6K  â€¦  201K                                    22 ( 3%)        âš¡- 99.7% Â±  0.8%
  cache_misses       4.80K  Â± 1.07K                               3.29K  â€¦ 9.38K                                    64 ( 9%)        âš¡-100.0% Â±  0.1%
  branch_misses       380K  Â± 3.98K                                376K  â€¦  411K                                    83 (11%)        âš¡- 94.1% Â±  1.1%
Benchmark 4 (61 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           995ms Â± 6.99ms                               983ms â€¦ 1.02s                                     1 ( 2%)        ðŸ’©+ 45.4% Â±  0.5%
  peak_rss           1.88GB Â± 52.5KB                              1.88GB â€¦ 1.88GB                                   12 (20%)        ðŸ’©+1448.1% Â±  0.0%
  cpu_cycles          196M  Â± 1.12M                                194M  â€¦  199M                                     2 ( 3%)        âš¡- 86.9% Â±  0.7%
  instructions        238M  Â± 8.47                                 238M  â€¦  238M                                     2 ( 3%)        âš¡- 90.6% Â±  0.0%
  cache_references   6.12M  Â±  267K                               5.60M  â€¦ 6.72M                                     0 ( 0%)        âš¡- 84.5% Â±  2.9%
  cache_misses        242K  Â± 10.5K                                226K  â€¦  269K                                     0 ( 0%)        âš¡- 98.0% Â±  0.2%
  branch_misses       605K  Â± 7.32K                                597K  â€¦  628K                                     5 ( 8%)        âš¡- 90.7% Â±  3.9%
Benchmark 5 (120 runs): ./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           504ms Â± 4.49ms                               496ms â€¦  523ms                                    2 ( 2%)        âš¡- 26.3% Â±  0.4%
  peak_rss           2.39MB Â± 57.6KB                              2.28MB â€¦ 2.54MB                                    0 ( 0%)        âš¡- 98.0% Â±  0.0%
  cpu_cycles          897M  Â± 12.1M                                881M  â€¦  965M                                     7 ( 6%)        âš¡- 39.9% Â±  0.5%
  instructions       1.38G  Â± 76.6K                               1.38G  â€¦ 1.38G                                     0 ( 0%)        âš¡- 45.3% Â±  0.0%
  cache_references   8.24M  Â± 3.40M                               3.44M  â€¦ 23.4M                                     5 ( 4%)        âš¡- 79.2% Â±  2.8%
  cache_misses       45.5K  Â± 6.40K                               36.2K  â€¦ 59.8K                                     0 ( 0%)        âš¡- 99.6% Â±  0.1%
  branch_misses      1.12M  Â±  206K                                887K  â€¦ 1.90M                                     2 ( 2%)        âš¡- 82.6% Â±  2.8%
Benchmark 6 (17 runs): ./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.68s  Â± 8.02ms                              3.67s  â€¦ 3.70s                                     2 (12%)        ðŸ’©+438.3% Â±  1.0%
  peak_rss           1.85GB Â± 66.5KB                              1.85GB â€¦ 1.85GB                                    0 ( 0%)        ðŸ’©+1416.8% Â±  0.1%
  cpu_cycles          881M  Â± 3.08M                                875M  â€¦  887M                                     0 ( 0%)        âš¡- 41.0% Â±  1.4%
  instructions        870M  Â± 11.1K                                870M  â€¦  870M                                     0 ( 0%)        âš¡- 65.6% Â±  0.0%
  cache_references   4.80M  Â±  289K                               4.35M  â€¦ 5.31M                                     0 ( 0%)        âš¡- 87.9% Â±  5.7%
  cache_misses        117K  Â± 4.21K                                111K  â€¦  124K                                     0 ( 0%)        âš¡- 99.0% Â±  0.4%
  branch_misses      1.75M  Â± 40.0K                               1.69M  â€¦ 1.81M                                     0 ( 0%)        âš¡- 73.0% Â±  7.4%

./nix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./lix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./narser/bin/narser unpack linux.nar out
cmp <(./nix/bin/nix nar pack out) linux.nar || exit 1
rm -rf out

rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.479s
user	0m0.342s
sys	0m1.122s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.472s
user	0m0.289s
sys	0m1.171s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.497s
user	0m0.318s
sys	0m1.172s

rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.705s
user	0m0.469s
sys	0m1.228s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.688s
user	0m0.458s
sys	0m1.217s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.684s
user	0m0.454s
sys	0m1.219s

rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.276s
user	0m0.178s
sys	0m1.091s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.281s
user	0m0.176s
sys	0m1.100s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.284s
user	0m0.200s
sys	0m1.078s
