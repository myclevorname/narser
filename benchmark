
echo $1
/tmp/clevor/tests

mkdir $1 || exit 1
cd $1

nix build git+https://git.lix.systems/lix-project/lix?rev=570f5b8d1f7ad4e3146dd307a223e8a6993ddcc5 -o lix >& /dev/null || exit 1
nix build github:NixOS/nix/b5e039b7c121c4164083646253e5df8dbb491225 -o nix >& /dev/null || exit 1
# narz fails in f790364c93142affa3cc699365545d6a11916a76
nix build git+https://git.sr.ht/~watersucks/narz?rev=760736b98e08c7c741838f5ad020d6d2e33b5e57 -o narz >& /dev/null || exit 1
nix build git+https://codeberg.org/clevor/narser?rev=ae08758c378740819cf95e0fdb1bef74e95039dd -o narser >& /dev/null || exit 1
nix build gitlab:abstract-binary/nix-nar-rs/8ad9e5d8b33b27bc63c93a05055416b22e33ea3f -o nix-nar >& /dev/null || exit 1

git clone https://github.com/torvalds/linux --depth=1 -q
cd linux
git log | head
commit dbf8fe85a16a33d6b6bd01f2bc606fc017771465
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Tue Dec 30 08:45:58 2025 -0800

    Merge tag 'net-6.19-rc4' of git://git.kernel.org/pub/scm/linux/kernel/git/netdev/net
    
    Pull networking fixes from Paolo Abeni:
     "Including fixes from Bluetooth and WiFi. Notably this includes the fix
      for the iwlwifi issue you reported.
    
cd ..

nix nar pack linux > linux.nar

cmp <(./nix/bin/nix nar pack linux) <(./lix/bin/nix nar dump-path linux)
cmp <(./nix/bin/nix nar pack linux) <(./narser/bin/narser pack linux) || exit 1
cmp <(./nix/bin/nix nar pack linux) <(./nix-nar/bin/nix-nar dump-path linux)

cmp <(./nix/bin/nix nar cat linux.nar /README) <(./lix/bin/nix nar cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narser/bin/narser cat linux.nar /README) || exit 1
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narz/bin/narz cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./nix-nar/bin/nix-nar cat linux.nar /README)

cmp <(./nix/bin/nix nar ls linux.nar /) <(./lix/bin/nix nar ls linux.nar /)
cmp <(./nix/bin/nix nar ls linux.nar /) <(./narser/bin/narser ls linux.nar /) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / 2> /dev/null) <(./narz/bin/narz ls linux.nar / 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar /) <(./nix-nar/bin/nix-nar ls linux.nar /)

cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./lix/bin/nix nar ls linux.nar / -l)
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./narser/bin/narser ls linux.nar / -l) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -l 2> /dev/null) <(./narz/bin/narz ls linux.nar / -l 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./nix-nar/bin/nix-nar ls linux.nar / -l)

cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./lix/bin/nix nar ls linux.nar / -lR)
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./narser/bin/narser ls linux.nar / -lR) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR 2> /dev/null) <(./narz/bin/narz ls linux.nar / -lr 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 3, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./nix-nar/bin/nix-nar ls linux.nar / -lR)

cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./lix/bin/nix nar ls linux.nar / -R)
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./narser/bin/narser ls linux.nar / -R) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -R 2> /dev/null) <(./narz/bin/narz ls linux.nar / -r 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 2, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./nix-nar/bin/nix-nar ls linux.nar / -R)


poop -d 60000 "./nix/bin/nix nar pack linux" "./lix/bin/nix nar dump-path linux" "./narser/bin/narser pack linux" "./nix-nar/bin/nix-nar dump-path linux"
Benchmark 1 (32 runs): ./nix/bin/nix nar pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.93s  Â± 58.8ms                              1.87s  â€¦ 2.04s                                     0 ( 0%)        0%
  peak_rss           38.1MB Â± 96.7KB                              37.9MB â€¦ 38.3MB                                    0 ( 0%)        0%
  cpu_cycles         3.56G  Â±  198M                               3.40G  â€¦ 3.93G                                     0 ( 0%)        0%
  instructions       7.52G  Â±  137K                               7.52G  â€¦ 7.52G                                     0 ( 0%)        0%
  cache_references   55.0M  Â± 3.25M                               49.4M  â€¦ 62.7M                                     0 ( 0%)        0%
  cache_misses       4.37M  Â± 40.9K                               4.25M  â€¦ 4.47M                                     3 ( 9%)        0%
  branch_misses      11.8M  Â± 4.45M                               8.17M  â€¦ 20.3M                                     0 ( 0%)        0%
Benchmark 2 (52 runs): ./lix/bin/nix nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.17s  Â± 10.0ms                              1.15s  â€¦ 1.20s                                     2 ( 4%)        âš¡- 39.5% Â±  0.9%
  peak_rss           34.5MB Â±  177KB                              34.2MB â€¦ 34.9MB                                    0 ( 0%)        âš¡-  9.5% Â±  0.2%
  cpu_cycles         1.37G  Â± 22.1M                               1.35G  â€¦ 1.49G                                     2 ( 4%)        âš¡- 61.4% Â±  1.5%
  instructions       1.94G  Â± 8.54K                               1.94G  â€¦ 1.94G                                     0 ( 0%)        âš¡- 74.2% Â±  0.0%
  cache_references   89.7M  Â± 3.75M                               82.5M  â€¦ 96.2M                                     0 ( 0%)        ðŸ’©+ 63.1% Â±  2.9%
  cache_misses        784K  Â± 24.7K                                754K  â€¦  907K                                     5 (10%)        âš¡- 82.1% Â±  0.3%
  branch_misses      3.63M  Â±  273K                               3.23M  â€¦ 4.43M                                     1 ( 2%)        âš¡- 69.1% Â± 10.4%
Benchmark 3 (83 runs): ./narser/bin/narser pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           729ms Â± 3.15ms                               722ms â€¦  738ms                                    0 ( 0%)        âš¡- 62.2% Â±  0.7%
  peak_rss           1.31MB Â± 62.9KB                              1.23MB â€¦ 1.36MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.1%
  cpu_cycles          183M  Â± 2.08M                                179M  â€¦  190M                                     1 ( 1%)        âš¡- 94.9% Â±  1.2%
  instructions        311M  Â± 16.1                                 311M  â€¦  311M                                     0 ( 0%)        âš¡- 95.9% Â±  0.0%
  cache_references   6.31M  Â±  281K                               5.65M  â€¦ 7.29M                                     2 ( 2%)        âš¡- 88.5% Â±  1.3%
  cache_misses        174K  Â± 11.5K                                156K  â€¦  244K                                     1 ( 1%)        âš¡- 96.0% Â±  0.2%
  branch_misses       806K  Â± 12.2K                                790K  â€¦  862K                                     1 ( 1%)        âš¡- 93.1% Â±  8.2%
Benchmark 4 (39 runs): ./nix-nar/bin/nix-nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.56s  Â± 5.42ms                              1.55s  â€¦ 1.57s                                     0 ( 0%)        âš¡- 18.9% Â±  1.0%
  peak_rss           3.39MB Â± 84.4KB                              3.17MB â€¦ 3.54MB                                    0 ( 0%)        âš¡- 91.1% Â±  0.1%
  cpu_cycles          555M  Â± 8.88M                                542M  â€¦  579M                                     0 ( 0%)        âš¡- 84.4% Â±  1.8%
  instructions        904M  Â± 7.56K                                904M  â€¦  904M                                     6 (15%)        âš¡- 88.0% Â±  0.0%
  cache_references   10.3M  Â±  529K                               9.35M  â€¦ 12.0M                                     1 ( 3%)        âš¡- 81.4% Â±  1.9%
  cache_misses        386K  Â± 13.8K                                362K  â€¦  416K                                     0 ( 0%)        âš¡- 91.2% Â±  0.3%
  branch_misses      3.09M  Â±  125K                               2.86M  â€¦ 3.44M                                     1 ( 3%)        âš¡- 73.7% Â± 12.1%

poop -d 60000 "./nix/bin/nix nar ls linux.nar /" "./lix/bin/nix nar ls linux.nar /" "./narser/bin/narser ls linux.nar /" "./nix-nar/bin/nix-nar ls linux.nar /" "./narz/bin/narz ls linux.nar /"
Benchmark 1 (153 runs): ./nix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           393ms Â± 3.58ms                               387ms â€¦  403ms                                    0 ( 0%)        0%
  peak_rss           71.2MB Â±  123KB                              70.9MB â€¦ 71.6MB                                    1 ( 1%)        0%
  cpu_cycles          559M  Â± 10.2M                                546M  â€¦  585M                                     0 ( 0%)        0%
  instructions       1.12G  Â±  157K                               1.12G  â€¦ 1.12G                                     0 ( 0%)        0%
  cache_references   9.37M  Â± 1.69M                               7.50M  â€¦ 19.3M                                    10 ( 7%)        0%
  cache_misses       2.28M  Â± 23.3K                               2.23M  â€¦ 2.34M                                     0 ( 0%)        0%
  branch_misses      1.70M  Â±  255K                               1.47M  â€¦ 2.36M                                     0 ( 0%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.64s  Â± 16.0ms                              2.62s  â€¦ 2.68s                                     0 ( 0%)        ðŸ’©+571.3% Â±  0.7%
  peak_rss           3.79GB Â±  117KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5219.6% Â±  0.1%
  cpu_cycles         3.02G  Â± 45.5M                               2.97G  â€¦ 3.10G                                     0 ( 0%)        ðŸ’©+440.4% Â±  1.5%
  instructions       2.33G  Â± 18.3K                               2.33G  â€¦ 2.33G                                     1 ( 4%)        ðŸ’©+107.4% Â±  0.0%
  cache_references    131M  Â± 2.33M                                129M  â€¦  139M                                     1 ( 4%)        ðŸ’©+1300.0% Â±  8.4%
  cache_misses       71.3M  Â±  129K                               71.0M  â€¦ 71.5M                                     0 ( 0%)        ðŸ’©+3026.5% Â±  1.0%
  branch_misses      4.12M  Â±  264K                               3.78M  â€¦ 4.72M                                     0 ( 0%)        ðŸ’©+142.9% Â±  6.6%
Benchmark 3 (571 runs): ./narser/bin/narser ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           105ms Â± 1.46ms                               104ms â€¦  112ms                                   67 (12%)        âš¡- 73.2% Â±  0.1%
  peak_rss           33.9MB Â± 13.4KB                              33.7MB â€¦ 33.9MB                                    6 ( 1%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles         67.6M  Â±  709K                               66.8M  â€¦ 72.7M                                    47 ( 8%)        âš¡- 87.9% Â±  0.2%
  instructions        129M  Â± 6.51                                 129M  â€¦  129M                                    17 ( 3%)        âš¡- 88.5% Â±  0.0%
  cache_references   1.23M  Â± 34.5K                               1.15M  â€¦ 1.35M                                     3 ( 1%)        âš¡- 86.8% Â±  1.5%
  cache_misses       17.4K  Â± 1.63K                               14.0K  â€¦ 23.4K                                    44 ( 8%)        âš¡- 99.2% Â±  0.1%
  branch_misses       399K  Â± 4.92K                                393K  â€¦  441K                                    55 (10%)        âš¡- 76.5% Â±  1.2%
Benchmark 4 (113 runs): ./nix-nar/bin/nix-nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           534ms Â± 3.20ms                               528ms â€¦  540ms                                    0 ( 0%)        ðŸ’©+ 35.8% Â±  0.2%
  peak_rss           2.87MB Â± 70.4KB                              2.72MB â€¦ 2.99MB                                   13 (12%)        âš¡- 96.0% Â±  0.0%
  cpu_cycles          984M  Â± 8.38M                                972M  â€¦ 1.01G                                     1 ( 1%)        ðŸ’©+ 76.0% Â±  0.4%
  instructions       1.64G  Â± 81.0K                               1.64G  â€¦ 1.64G                                     0 ( 0%)        ðŸ’©+ 46.3% Â±  0.0%
  cache_references   7.61M  Â± 2.49M                               4.39M  â€¦ 16.4M                                     2 ( 2%)        âš¡- 18.8% Â±  5.4%
  cache_misses       57.9K  Â± 8.55K                               43.9K  â€¦ 75.5K                                     0 ( 0%)        âš¡- 97.5% Â±  0.2%
  branch_misses      1.17M  Â±  165K                                953K  â€¦ 1.69M                                     1 ( 1%)        âš¡- 31.2% Â±  3.2%
Benchmark 5 (17 runs): ./narz/bin/narz ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.71s  Â± 6.84ms                              3.69s  â€¦ 3.72s                                     1 ( 6%)        ðŸ’©+843.4% Â±  0.5%
  peak_rss           1.86GB Â± 81.0KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+2516.2% Â±  0.1%
  cpu_cycles          893M  Â± 4.40M                                887M  â€¦  906M                                     1 ( 6%)        ðŸ’©+ 59.7% Â±  0.9%
  instructions        879M  Â±  161                                 879M  â€¦  879M                                     1 ( 6%)        âš¡- 21.7% Â±  0.0%
  cache_references   4.68M  Â±  205K                               4.21M  â€¦ 5.04M                                     3 (18%)        âš¡- 50.0% Â±  8.6%
  cache_misses        120K  Â± 7.41K                                111K  â€¦  139K                                     2 (12%)        âš¡- 94.7% Â±  0.5%
  branch_misses      1.83M  Â± 37.3K                               1.74M  â€¦ 1.90M                                     1 ( 6%)          +  7.9% Â±  7.2%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -R" "./lix/bin/nix nar ls linux.nar / -R" "./narser/bin/narser ls linux.nar / -R" "./nix-nar/bin/nix-nar ls linux.nar / -R" "./narz/bin/narz ls linux.nar / -r"
Benchmark 1 (96 runs): ./nix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           630ms Â± 10.4ms                               617ms â€¦  671ms                                    1 ( 1%)        0%
  peak_rss           71.2MB Â±  129KB                              71.0MB â€¦ 71.6MB                                    2 ( 2%)        0%
  cpu_cycles          972M  Â± 32.1M                                940M  â€¦ 1.06G                                     0 ( 0%)        0%
  instructions       1.85G  Â±  394K                               1.85G  â€¦ 1.85G                                     5 ( 5%)        0%
  cache_references   19.3M  Â± 1.53M                               17.4M  â€¦ 24.7M                                    11 (11%)        0%
  cache_misses       4.76M  Â± 78.5K                               4.60M  â€¦ 5.03M                                     4 ( 4%)        0%
  branch_misses      4.28M  Â±  783K                               3.60M  â€¦ 6.18M                                     0 ( 0%)        0%
Benchmark 2 (21 runs): ./lix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.90s  Â± 14.6ms                              2.88s  â€¦ 2.94s                                     0 ( 0%)        ðŸ’©+360.9% Â±  0.8%
  peak_rss           3.79GB Â±  182KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5219.7% Â±  0.1%
  cpu_cycles         3.52G  Â± 47.7M                               3.47G  â€¦ 3.61G                                     0 ( 0%)        ðŸ’©+262.0% Â±  1.7%
  instructions       3.24G  Â± 1.00M                               3.24G  â€¦ 3.24G                                     0 ( 0%)        ðŸ’©+ 75.0% Â±  0.0%
  cache_references    134M  Â± 4.08M                                130M  â€¦  150M                                     2 (10%)        ðŸ’©+593.9% Â±  5.5%
  cache_misses       72.1M  Â± 98.9K                               72.0M  â€¦ 72.3M                                     0 ( 0%)        ðŸ’©+1416.8% Â±  0.8%
  branch_misses      5.73M  Â±  338K                               5.45M  â€¦ 7.07M                                     1 ( 5%)        ðŸ’©+ 33.9% Â±  8.1%
Benchmark 3 (462 runs): ./narser/bin/narser ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           130ms Â± 2.20ms                               127ms â€¦  146ms                                    6 ( 1%)        âš¡- 79.3% Â±  0.2%
  peak_rss           33.9MB Â± 13.6KB                              33.7MB â€¦ 33.9MB                                    5 ( 1%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles          152M  Â± 3.62M                                148M  â€¦  191M                                   106 (23%)        âš¡- 84.3% Â±  0.3%
  instructions        305M  Â± 10.1                                 305M  â€¦  305M                                    18 ( 4%)        âš¡- 83.5% Â±  0.0%
  cache_references   2.32M  Â± 39.9K                               2.21M  â€¦ 2.48M                                     7 ( 2%)        âš¡- 87.9% Â±  0.7%
  cache_misses        901K  Â± 12.6K                                874K  â€¦  975K                                    74 (16%)        âš¡- 81.1% Â±  0.2%
  branch_misses       553K  Â± 5.91K                                548K  â€¦  600K                                    44 (10%)        âš¡- 87.1% Â±  1.7%
Benchmark 4 (91 runs): ./nix-nar/bin/nix-nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           662ms Â± 6.88ms                               653ms â€¦  705ms                                    4 ( 4%)        ðŸ’©+  5.1% Â±  0.4%
  peak_rss           15.3MB Â± 77.5KB                              15.2MB â€¦ 15.5MB                                    0 ( 0%)        âš¡- 78.5% Â±  0.0%
  cpu_cycles         1.20G  Â± 19.9M                               1.18G  â€¦ 1.35G                                     4 ( 4%)        ðŸ’©+ 23.0% Â±  0.8%
  instructions       2.16G  Â± 81.5K                               2.16G  â€¦ 2.16G                                     0 ( 0%)        ðŸ’©+ 16.7% Â±  0.0%
  cache_references   13.3M  Â± 3.90M                               8.05M  â€¦ 28.3M                                     3 ( 3%)        âš¡- 30.9% Â±  4.4%
  cache_misses        198K  Â± 10.3K                                172K  â€¦  216K                                     0 ( 0%)        âš¡- 95.8% Â±  0.3%
  branch_misses      1.80M  Â±  299K                               1.48M  â€¦ 3.67M                                     3 ( 3%)        âš¡- 58.0% Â±  4.0%
Benchmark 5 (16 runs): ./narz/bin/narz ls linux.nar / -r
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.90s  Â± 9.41ms                              3.87s  â€¦ 3.91s                                     4 (25%)        ðŸ’©+519.2% Â±  0.9%
  peak_rss           1.86GB Â± 68.4KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+2516.9% Â±  0.1%
  cpu_cycles          981M  Â± 4.23M                                974M  â€¦  990M                                     1 ( 6%)          +  0.9% Â±  1.6%
  instructions        962M  Â±  216                                 962M  â€¦  962M                                     1 ( 6%)        âš¡- 48.0% Â±  0.0%
  cache_references   5.85M  Â±  469K                               5.15M  â€¦ 6.87M                                     4 (25%)        âš¡- 69.6% Â±  4.0%
  cache_misses        878K  Â± 4.97K                                872K  â€¦  888K                                     0 ( 0%)        âš¡- 81.5% Â±  0.8%
  branch_misses      2.15M  Â± 44.8K                               2.08M  â€¦ 2.22M                                     0 ( 0%)        âš¡- 49.8% Â±  9.1%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -Rl" "./lix/bin/nix nar ls linux.nar / -Rl" "./narser/bin/narser ls linux.nar / -Rl" "./nix-nar/bin/nix-nar ls linux.nar / -Rl" "./narz/bin/narz ls linux.nar / -rl"
Benchmark 1 (84 runs): ./nix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           719ms Â± 15.6ms                               701ms â€¦  754ms                                    0 ( 0%)        0%
  peak_rss           71.3MB Â±  119KB                              71.0MB â€¦ 71.5MB                                    0 ( 0%)        0%
  cpu_cycles         1.28G  Â± 51.5M                               1.23G  â€¦ 1.39G                                     0 ( 0%)        0%
  instructions       2.55G  Â±  313K                               2.55G  â€¦ 2.55G                                     0 ( 0%)        0%
  cache_references   20.1M  Â± 1.73M                               18.2M  â€¦ 29.8M                                     2 ( 2%)        0%
  cache_misses       4.84M  Â± 78.6K                               4.70M  â€¦ 5.03M                                     0 ( 0%)        0%
  branch_misses      5.02M  Â± 1.13M                               4.01M  â€¦ 7.07M                                     0 ( 0%)        0%
Benchmark 2 (20 runs): ./lix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.02s  Â± 14.7ms                              3.00s  â€¦ 3.06s                                     1 ( 5%)        ðŸ’©+320.1% Â±  1.1%
  peak_rss           3.79GB Â±  169KB                              3.79GB â€¦ 3.79GB                                    2 (10%)        ðŸ’©+5219.0% Â±  0.1%
  cpu_cycles         3.93G  Â± 36.8M                               3.88G  â€¦ 4.00G                                     0 ( 0%)        ðŸ’©+206.4% Â±  1.9%
  instructions       4.17G  Â±  681K                               4.17G  â€¦ 4.17G                                     0 ( 0%)        ðŸ’©+ 63.3% Â±  0.0%
  cache_references    134M  Â± 1.71M                                133M  â€¦  141M                                     1 ( 5%)        ðŸ’©+569.5% Â±  4.2%
  cache_misses       72.1M  Â±  171K                               71.9M  â€¦ 72.5M                                     0 ( 0%)        ðŸ’©+1390.5% Â±  1.0%
  branch_misses      6.57M  Â±  487K                               6.06M  â€¦ 7.67M                                     0 ( 0%)        ðŸ’©+ 31.0% Â± 10.2%
Benchmark 3 (450 runs): ./narser/bin/narser ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           133ms Â± 2.18ms                               131ms â€¦  150ms                                   25 ( 6%)        âš¡- 81.4% Â±  0.2%
  peak_rss           33.9MB Â± 21.1KB                              33.7MB â€¦ 33.9MB                                   12 ( 3%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles          164M  Â± 3.20M                                160M  â€¦  203M                                    90 (20%)        âš¡- 87.2% Â±  0.4%
  instructions        345M  Â± 10.3                                 345M  â€¦  345M                                    33 ( 7%)        âš¡- 86.5% Â±  0.0%
  cache_references   2.45M  Â± 36.5K                               2.33M  â€¦ 2.58M                                     8 ( 2%)        âš¡- 87.8% Â±  0.8%
  cache_misses        902K  Â± 12.6K                                873K  â€¦  978K                                    50 (11%)        âš¡- 81.4% Â±  0.2%
  branch_misses       600K  Â± 5.60K                                594K  â€¦  646K                                    44 (10%)        âš¡- 88.0% Â±  2.1%
Benchmark 4 (87 runs): ./nix-nar/bin/nix-nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           696ms Â± 5.93ms                               687ms â€¦  719ms                                    4 ( 5%)        âš¡-  3.3% Â±  0.5%
  peak_rss           15.3MB Â± 85.2KB                              15.2MB â€¦ 15.5MB                                   14 (16%)        âš¡- 78.5% Â±  0.0%
  cpu_cycles         1.31G  Â± 14.7M                               1.30G  â€¦ 1.38G                                     5 ( 6%)        ðŸ’©+  2.4% Â±  0.9%
  instructions       2.50G  Â± 79.3K                               2.50G  â€¦ 2.50G                                     0 ( 0%)        âš¡-  2.0% Â±  0.0%
  cache_references   13.2M  Â± 3.31M                               7.79M  â€¦ 25.8M                                     6 ( 7%)        âš¡- 34.1% Â±  4.0%
  cache_misses        331K  Â± 11.2K                                306K  â€¦  353K                                     0 ( 0%)        âš¡- 93.2% Â±  0.3%
  branch_misses      1.99M  Â±  216K                               1.67M  â€¦ 2.67M                                     2 ( 2%)        âš¡- 60.3% Â±  4.8%
Benchmark 5 (12 runs): ./narz/bin/narz ls linux.nar / -rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          5.11s  Â± 13.6ms                              5.09s  â€¦ 5.13s                                     0 ( 0%)        ðŸ’©+610.4% Â±  1.3%
  peak_rss           1.86GB Â± 83.3KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+2516.6% Â±  0.1%
  cpu_cycles         1.16G  Â± 2.47M                               1.15G  â€¦ 1.16G                                     0 ( 0%)        âš¡-  9.7% Â±  2.3%
  instructions       1.13G  Â±  167                                1.13G  â€¦ 1.13G                                     0 ( 0%)        âš¡- 55.7% Â±  0.0%
  cache_references   6.02M  Â±  475K                               5.25M  â€¦ 7.07M                                     3 (25%)        âš¡- 70.0% Â±  5.0%
  cache_misses        880K  Â± 6.00K                                870K  â€¦  888K                                     0 ( 0%)        âš¡- 81.8% Â±  0.9%
  branch_misses      2.51M  Â± 50.2K                               2.41M  â€¦ 2.59M                                     0 ( 0%)        âš¡- 50.0% Â± 13.0%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -l" "./lix/bin/nix nar ls linux.nar / -l" "./narser/bin/narser ls linux.nar / -l" "./nix-nar/bin/nix-nar ls linux.nar / -l" "./narz/bin/narz ls linux.nar / -l"
Benchmark 1 (153 runs): ./nix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           394ms Â± 4.90ms                               387ms â€¦  414ms                                    1 ( 1%)        0%
  peak_rss           71.2MB Â±  113KB                              70.9MB â€¦ 71.6MB                                    3 ( 2%)        0%
  cpu_cycles          563M  Â± 13.3M                                546M  â€¦  605M                                     0 ( 0%)        0%
  instructions       1.12G  Â±  158K                               1.12G  â€¦ 1.12G                                     0 ( 0%)        0%
  cache_references   9.30M  Â± 1.77M                               7.64M  â€¦ 20.0M                                    15 (10%)        0%
  cache_misses       2.28M  Â± 22.2K                               2.23M  â€¦ 2.35M                                     5 ( 3%)        0%
  branch_misses      1.81M  Â±  306K                               1.48M  â€¦ 2.85M                                     0 ( 0%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.65s  Â± 15.7ms                              2.62s  â€¦ 2.67s                                     0 ( 0%)        ðŸ’©+571.3% Â±  0.8%
  peak_rss           3.79GB Â±  101KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5221.5% Â±  0.1%
  cpu_cycles         3.03G  Â± 43.1M                               2.98G  â€¦ 3.10G                                     0 ( 0%)        ðŸ’©+437.4% Â±  1.5%
  instructions       2.33G  Â± 16.8K                               2.33G  â€¦ 2.33G                                     1 ( 4%)        ðŸ’©+107.4% Â±  0.0%
  cache_references    132M  Â± 2.17M                                129M  â€¦  139M                                     1 ( 4%)        ðŸ’©+1316.8% Â±  8.6%
  cache_misses       71.2M  Â±  116K                               71.0M  â€¦ 71.5M                                     0 ( 0%)        ðŸ’©+3018.9% Â±  0.9%
  branch_misses      4.12M  Â±  298K                               3.81M  â€¦ 5.07M                                     1 ( 4%)        ðŸ’©+127.5% Â±  7.4%
Benchmark 3 (570 runs): ./narser/bin/narser ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           105ms Â± 1.70ms                               104ms â€¦  122ms                                   50 ( 9%)        âš¡- 73.3% Â±  0.1%
  peak_rss           33.9MB Â± 16.4KB                              33.7MB â€¦ 33.9MB                                    9 ( 2%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles         67.6M  Â±  716K                               66.9M  â€¦ 75.6M                                    30 ( 5%)        âš¡- 88.0% Â±  0.2%
  instructions        129M  Â± 6.84                                 129M  â€¦  129M                                    26 ( 5%)        âš¡- 88.5% Â±  0.0%
  cache_references   1.23M  Â± 36.0K                               1.12M  â€¦ 1.35M                                     5 ( 1%)        âš¡- 86.8% Â±  1.6%
  cache_misses       17.5K  Â± 1.73K                               14.1K  â€¦ 23.6K                                    34 ( 6%)        âš¡- 99.2% Â±  0.1%
  branch_misses       398K  Â± 4.94K                                393K  â€¦  466K                                    42 ( 7%)        âš¡- 78.0% Â±  1.4%
Benchmark 4 (113 runs): ./nix-nar/bin/nix-nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           535ms Â± 5.59ms                               528ms â€¦  572ms                                    3 ( 3%)        ðŸ’©+ 35.6% Â±  0.3%
  peak_rss           2.88MB Â± 63.3KB                              2.72MB â€¦ 3.04MB                                    7 ( 6%)        âš¡- 96.0% Â±  0.0%
  cpu_cycles          987M  Â± 16.5M                                971M  â€¦ 1.12G                                     3 ( 3%)        ðŸ’©+ 75.2% Â±  0.6%
  instructions       1.64G  Â± 79.7K                               1.64G  â€¦ 1.64G                                     0 ( 0%)        ðŸ’©+ 46.3% Â±  0.0%
  cache_references   7.51M  Â± 2.31M                               4.19M  â€¦ 13.7M                                     5 ( 4%)        âš¡- 19.2% Â±  5.3%
  cache_misses       59.5K  Â± 8.40K                               44.5K  â€¦ 77.3K                                     0 ( 0%)        âš¡- 97.4% Â±  0.2%
  branch_misses      1.25M  Â±  273K                                979K  â€¦ 2.99M                                     2 ( 2%)        âš¡- 31.1% Â±  3.9%
Benchmark 5 (17 runs): ./narz/bin/narz ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.71s  Â± 8.31ms                              3.69s  â€¦ 3.73s                                     2 (12%)        ðŸ’©+840.6% Â±  0.7%
  peak_rss           1.86GB Â± 77.1KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+2517.1% Â±  0.1%
  cpu_cycles          892M  Â± 2.24M                                887M  â€¦  896M                                     0 ( 0%)        ðŸ’©+ 58.3% Â±  1.1%
  instructions        879M  Â±  128                                 879M  â€¦  879M                                     2 (12%)        âš¡- 21.7% Â±  0.0%
  cache_references   4.90M  Â±  430K                               4.31M  â€¦ 5.84M                                     3 (18%)        âš¡- 47.3% Â±  9.1%
  cache_misses        120K  Â± 5.70K                                109K  â€¦  129K                                     0 ( 0%)        âš¡- 94.7% Â±  0.5%
  branch_misses      1.84M  Â± 40.6K                               1.78M  â€¦ 1.93M                                     0 ( 0%)          +  1.9% Â±  8.1%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /README" "./lix/bin/nix nar cat linux.nar /README" "./narser/bin/narser cat linux.nar /README" "./narser/bin/narser cat linux.nar /README -f" "./narser/bin/narser cat linux.nar /README -L" "./nix-nar/bin/nix-nar cat linux.nar /README " "./narz/bin/narz cat linux.nar /README"
Benchmark 1 (348 runs): ./nix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           172ms Â± 6.75ms                               169ms â€¦  262ms                                   10 ( 3%)        0%
  peak_rss           30.6MB Â±  150KB                              30.2MB â€¦ 31.1MB                                    2 ( 1%)        0%
  cpu_cycles          267M  Â± 21.0M                                257M  â€¦  562M                                     7 ( 2%)        0%
  instructions        644M  Â±  172K                                644M  â€¦  645M                                     7 ( 2%)        0%
  cache_references   2.41M  Â±  267K                               2.05M  â€¦ 4.93M                                    14 ( 4%)        0%
  cache_misses        372K  Â± 22.5K                                353K  â€¦  656K                                    52 (15%)        0%
  branch_misses       787K  Â±  515K                                573K  â€¦ 8.22M                                     9 ( 3%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.64s  Â± 15.5ms                              2.62s  â€¦ 2.67s                                     0 ( 0%)        ðŸ’©+1428.7% Â±  1.9%
  peak_rss           3.79GB Â± 82.8KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+12289.9% Â±  0.2%
  cpu_cycles         3.03G  Â± 36.2M                               3.00G  â€¦ 3.10G                                     0 ( 0%)        ðŸ’©+1034.2% Â±  3.5%
  instructions       2.36G  Â± 6.55K                               2.36G  â€¦ 2.36G                                     0 ( 0%)        ðŸ’©+266.4% Â±  0.0%
  cache_references    131M  Â± 2.23M                                130M  â€¦  141M                                     1 ( 4%)        ðŸ’©+5366.1% Â± 10.6%
  cache_misses       72.4M  Â±  179K                               72.1M  â€¦ 72.8M                                     0 ( 0%)        ðŸ’©+19355.0% Â±  5.5%
  branch_misses      4.14M  Â±  212K                               3.92M  â€¦ 4.73M                                     1 ( 4%)        ðŸ’©+426.5% Â± 26.9%
Benchmark 3 (718 runs): ./narser/bin/narser cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          83.5ms Â±  687us                              83.0ms â€¦ 90.1ms                                   37 ( 5%)        âš¡- 51.6% Â±  0.3%
  peak_rss           1.05MB Â±    0                                1.05MB â€¦ 1.05MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         47.5M  Â±  625K                               47.0M  â€¦ 53.5M                                    94 (13%)        âš¡- 82.2% Â±  0.6%
  instructions       99.8M  Â± 4.46                                99.8M  â€¦ 99.8M                                     2 ( 0%)        âš¡- 84.5% Â±  0.0%
  cache_references    160K  Â± 20.4K                                111K  â€¦  230K                                     8 ( 1%)        âš¡- 93.4% Â±  0.8%
  cache_misses       5.40K  Â± 1.54K                               3.65K  â€¦ 12.4K                                    63 ( 9%)        âš¡- 98.5% Â±  0.4%
  branch_misses       378K  Â± 4.57K                                374K  â€¦  434K                                    87 (12%)        âš¡- 52.0% Â±  4.8%
Benchmark 4 (6998 runs): ./narser/bin/narser cat linux.nar /README -f
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          8.53ms Â±  313us                              8.38ms â€¦ 14.6ms                                  245 ( 4%)        âš¡- 95.1% Â±  0.1%
  peak_rss           1.05MB Â±  783                                 983KB â€¦ 1.05MB                                    1 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         5.73M  Â±  216K                               5.63M  â€¦ 8.69M                                   340 ( 5%)        âš¡- 97.9% Â±  0.2%
  instructions       11.5M  Â± 1.75                                11.5M  â€¦ 11.5M                                    59 ( 1%)        âš¡- 98.2% Â±  0.0%
  cache_references   24.8K  Â± 3.45K                               19.0K  â€¦ 66.8K                                   144 ( 2%)        âš¡- 99.0% Â±  0.3%
  cache_misses       1.37K  Â±  385                                 944   â€¦ 8.74K                                   240 ( 3%)        âš¡- 99.6% Â±  0.1%
  branch_misses      49.6K  Â± 1.32K                               48.2K  â€¦ 71.7K                                   153 ( 2%)        âš¡- 93.7% Â±  1.5%
Benchmark 5 (60 runs): ./narser/bin/narser cat linux.nar /README -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.02s  Â± 7.64ms                              1.00s  â€¦ 1.03s                                     0 ( 0%)        ðŸ’©+489.1% Â±  1.1%
  peak_rss           1.90GB Â± 16.9KB                              1.90GB â€¦ 1.90GB                                    1 ( 2%)        ðŸ’©+6115.9% Â±  0.1%
  cpu_cycles          208M  Â±  998K                                206M  â€¦  210M                                     0 ( 0%)        âš¡- 22.2% Â±  2.0%
  instructions        247M  Â± 9.59                                 247M  â€¦  247M                                     0 ( 0%)        âš¡- 61.7% Â±  0.0%
  cache_references   7.18M  Â±  458K                               6.49M  â€¦ 8.83M                                     3 ( 5%)        ðŸ’©+198.7% Â±  3.4%
  cache_misses        280K  Â± 10.4K                                257K  â€¦  308K                                     0 ( 0%)        âš¡- 24.7% Â±  1.6%
  branch_misses       630K  Â± 9.50K                                613K  â€¦  653K                                     0 ( 0%)        âš¡- 19.9% Â± 16.6%
Benchmark 6 (758 runs): ./nix-nar/bin/nix-nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          79.2ms Â± 1.06ms                              78.1ms â€¦ 87.7ms                                   57 ( 8%)        âš¡- 54.1% Â±  0.3%
  peak_rss           2.90MB Â± 49.5KB                              2.72MB â€¦ 3.02MB                                   15 ( 2%)        âš¡- 90.5% Â±  0.0%
  cpu_cycles          119M  Â± 1.47M                                118M  â€¦  135M                                    55 ( 7%)        âš¡- 55.4% Â±  0.6%
  instructions        179M  Â± 10.3K                                179M  â€¦  179M                                     0 ( 0%)        âš¡- 72.1% Â±  0.0%
  cache_references   1.33M  Â±  501K                                549K  â€¦ 4.03M                                    25 ( 3%)        âš¡- 44.5% Â±  2.3%
  cache_misses       23.0K  Â± 2.96K                               19.4K  â€¦ 43.7K                                    63 ( 8%)        âš¡- 93.8% Â±  0.4%
  branch_misses       123K  Â± 22.7K                                111K  â€¦  470K                                    70 ( 9%)        âš¡- 84.3% Â±  4.7%
Benchmark 7 (17 runs): ./narz/bin/narz cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.69s  Â± 5.59ms                              3.68s  â€¦ 3.70s                                     0 ( 0%)        ðŸ’©+2042.0% Â±  1.9%
  peak_rss           1.86GB Â± 66.5KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+5992.3% Â±  0.2%
  cpu_cycles          891M  Â± 3.11M                                887M  â€¦  895M                                     0 ( 0%)        ðŸ’©+233.6% Â±  3.8%
  instructions        879M  Â± 9.10K                                879M  â€¦  879M                                     0 ( 0%)        ðŸ’©+ 36.5% Â±  0.0%
  cache_references   4.62M  Â± 97.3K                               4.41M  â€¦ 4.81M                                     3 (18%)        ðŸ’©+ 92.0% Â±  5.3%
  cache_misses        120K  Â± 5.52K                                112K  â€¦  133K                                     0 ( 0%)        âš¡- 67.6% Â±  2.9%
  branch_misses      1.83M  Â± 34.0K                               1.76M  â€¦ 1.89M                                     0 ( 0%)        ðŸ’©+132.6% Â± 31.2%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -f" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L" "./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c " "./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c"
Benchmark 1 (351 runs): ./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           171ms Â± 2.47ms                               169ms â€¦  184ms                                    5 ( 1%)        0%
  peak_rss           30.6MB Â±  149KB                              30.2MB â€¦ 31.1MB                                    7 ( 2%)        0%
  cpu_cycles          263M  Â± 7.28M                                257M  â€¦  295M                                     2 ( 1%)        0%
  instructions        644M  Â±  165K                                644M  â€¦  645M                                     4 ( 1%)        0%
  cache_references   2.43M  Â±  274K                               2.00M  â€¦ 4.26M                                    19 ( 5%)        0%
  cache_misses        370K  Â± 17.1K                                349K  â€¦  481K                                    51 (15%)        0%
  branch_misses       706K  Â±  165K                                572K  â€¦ 1.45M                                     2 ( 1%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.64s  Â± 16.3ms                              2.61s  â€¦ 2.67s                                     0 ( 0%)        ðŸ’©+1439.1% Â±  1.1%
  peak_rss           3.79GB Â±  123KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+12278.7% Â±  0.2%
  cpu_cycles         3.03G  Â± 42.6M                               2.99G  â€¦ 3.12G                                     0 ( 0%)        ðŸ’©+1048.9% Â±  2.0%
  instructions       2.36G  Â± 22.4K                               2.36G  â€¦ 2.36G                                     2 ( 9%)        ðŸ’©+266.4% Â±  0.0%
  cache_references    132M  Â± 2.43M                                129M  â€¦  138M                                     2 ( 9%)        ðŸ’©+5324.8% Â± 11.3%
  cache_misses       72.3M  Â±  186K                               72.1M  â€¦ 72.8M                                     3 (13%)        ðŸ’©+19446.8% Â±  5.5%
  branch_misses      4.08M  Â±  331K                               3.85M  â€¦ 5.44M                                     2 ( 9%)        ðŸ’©+478.0% Â± 10.7%
Benchmark 3 (715 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          83.9ms Â± 1.20ms                              83.1ms â€¦ 90.3ms                                   69 (10%)        âš¡- 51.0% Â±  0.1%
  peak_rss           1.04MB Â±    0                                1.04MB â€¦ 1.04MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         47.9M  Â±  590K                               47.4M  â€¦ 53.5M                                    81 (11%)        âš¡- 81.8% Â±  0.2%
  instructions       99.8M  Â± 13.9                                99.8M  â€¦ 99.8M                                    35 ( 5%)        âš¡- 84.5% Â±  0.0%
  cache_references    159K  Â± 21.4K                                108K  â€¦  232K                                     5 ( 1%)        âš¡- 93.5% Â±  0.8%
  cache_misses       5.47K  Â± 1.55K                               3.74K  â€¦ 13.1K                                    68 (10%)        âš¡- 98.5% Â±  0.3%
  branch_misses       376K  Â± 4.14K                                371K  â€¦  436K                                    69 (10%)        âš¡- 46.8% Â±  1.7%
Benchmark 4 (713 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -f
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          84.2ms Â± 1.62ms                              83.1ms â€¦ 91.3ms                                  108 (15%)        âš¡- 50.8% Â±  0.1%
  peak_rss           1.04MB Â±    0                                1.04MB â€¦ 1.04MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         48.0M  Â±  832K                               47.4M  â€¦ 58.7M                                    93 (13%)        âš¡- 81.8% Â±  0.2%
  instructions       99.8M  Â± 20.4                                99.8M  â€¦ 99.8M                                    46 ( 6%)        âš¡- 84.5% Â±  0.0%
  cache_references    162K  Â± 21.9K                                112K  â€¦  260K                                    21 ( 3%)        âš¡- 93.3% Â±  0.8%
  cache_misses       5.56K  Â± 1.61K                               3.59K  â€¦ 12.8K                                    66 ( 9%)        âš¡- 98.5% Â±  0.3%
  branch_misses       377K  Â± 7.35K                                371K  â€¦  489K                                    97 (14%)        âš¡- 46.6% Â±  1.7%
Benchmark 5 (59 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.02s  Â± 7.72ms                              1.00s  â€¦ 1.04s                                     2 ( 3%)        ðŸ’©+497.2% Â±  0.6%
  peak_rss           1.90GB Â± 36.8KB                              1.90GB â€¦ 1.90GB                                    5 ( 8%)        ðŸ’©+6110.1% Â±  0.1%
  cpu_cycles          209M  Â± 1.31M                                207M  â€¦  214M                                     2 ( 3%)        âš¡- 20.7% Â±  0.7%
  instructions        247M  Â± 9.03                                 247M  â€¦  247M                                     2 ( 3%)        âš¡- 61.7% Â±  0.0%
  cache_references   6.92M  Â±  296K                               6.36M  â€¦ 7.89M                                     1 ( 2%)        ðŸ’©+185.1% Â±  3.2%
  cache_misses        282K  Â± 12.1K                                258K  â€¦  308K                                     0 ( 0%)        âš¡- 23.7% Â±  1.2%
  branch_misses       641K  Â± 15.0K                                624K  â€¦  729K                                     1 ( 2%)        âš¡-  9.2% Â±  6.0%
Benchmark 6 (116 runs): ./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           518ms Â± 3.75ms                               512ms â€¦  527ms                                    0 ( 0%)        ðŸ’©+202.5% Â±  0.3%
  peak_rss           2.89MB Â± 67.9KB                              2.72MB â€¦ 3.02MB                                   10 ( 9%)        âš¡- 90.6% Â±  0.1%
  cpu_cycles          931M  Â± 8.36M                                920M  â€¦  957M                                     1 ( 1%)        ðŸ’©+253.5% Â±  0.6%
  instructions       1.50G  Â± 79.3K                               1.50G  â€¦ 1.50G                                     0 ( 0%)        ðŸ’©+133.1% Â±  0.0%
  cache_references   7.02M  Â± 3.04M                               3.12M  â€¦ 20.2M                                     9 ( 8%)        ðŸ’©+189.4% Â± 13.2%
  cache_misses       53.4K  Â± 8.25K                               40.1K  â€¦ 70.5K                                     0 ( 0%)        âš¡- 85.6% Â±  0.9%
  branch_misses      1.08M  Â±  173K                                901K  â€¦ 1.73M                                     8 ( 7%)        ðŸ’©+ 53.0% Â±  5.0%
Benchmark 7 (17 runs): ./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.72s  Â± 15.2ms                              3.69s  â€¦ 3.74s                                     3 (18%)        ðŸ’©+2070.3% Â±  1.1%
  peak_rss           1.86GB Â± 51.5KB                              1.86GB â€¦ 1.86GB                                    3 (18%)        ðŸ’©+5986.5% Â±  0.2%
  cpu_cycles          894M  Â± 3.47M                                889M  â€¦  901M                                     0 ( 0%)        ðŸ’©+239.3% Â±  1.3%
  instructions        879M  Â± 9.75K                                879M  â€¦  879M                                     0 ( 0%)        ðŸ’©+ 36.4% Â±  0.0%
  cache_references   4.81M  Â±  273K                               4.46M  â€¦ 5.48M                                     0 ( 0%)        ðŸ’©+ 98.2% Â±  5.5%
  cache_misses        125K  Â± 7.02K                                117K  â€¦  140K                                     0 ( 0%)        âš¡- 66.1% Â±  2.2%
  branch_misses      1.86M  Â± 46.9K                               1.77M  â€¦ 1.93M                                     0 ( 0%)        ðŸ’©+162.8% Â± 11.2%

./nix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./lix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./narser/bin/narser unpack linux.nar out
cmp <(./nix/bin/nix nar pack out) linux.nar || exit 1
rm -rf out

rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.512s
user	0m0.310s
sys	0m1.183s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.493s
user	0m0.328s
sys	0m1.155s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.498s
user	0m0.332s
sys	0m1.158s

rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.681s
user	0m0.532s
sys	0m1.143s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.700s
user	0m0.537s
sys	0m1.153s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.681s
user	0m0.470s
sys	0m1.203s

rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.269s
user	0m0.162s
sys	0m1.100s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.276s
user	0m0.162s
sys	0m1.107s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.276s
user	0m0.163s
sys	0m1.098s
