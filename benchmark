
echo $1
/tmp/clevor/tests

mkdir $1 || exit 1
cd $1

nix build git+https://git.lix.systems/lix-project/lix?rev=36a61d922c51a16b57a88f44833960bf32c92d39 -o lix >& /dev/null || exit 1
nix build github:NixOS/nix/8b955d80c2d73dcf9a87127b1afd37d3d1f5d220 -o nix >& /dev/null || exit 1
# narz fails in f790364c93142affa3cc699365545d6a11916a76
nix build git+https://git.sr.ht/~watersucks/narz?rev=760736b98e08c7c741838f5ad020d6d2e33b5e57 -o narz >& /dev/null || exit 1
nix build git+https://codeberg.org/clevor/narser?rev=bb37d718c120db4aea7b115fe48f9a506e8fbc93 -o narser >& /dev/null || exit 1
nix build gitlab:abstract-binary/nix-nar-rs/c8d9250b9be837abafa0046cb9c2a852b846da6a -o nix-nar >& /dev/null || exit 1

git clone https://github.com/torvalds/linux --depth=1 -q
cd linux
git log | head
commit 5c179cac051943f673c8baa53214e2566bfe69dc
Author: Linus Torvalds <torvalds@linux-foundation.org>
Date:   Thu Dec 11 08:01:52 2025 +0900

    Merge tag 'alpha-for-v6.19-tag' of git://git.kernel.org/pub/scm/linux/kernel/git/lindholm/alpha
    
    Pull alpha updates from Magnus Lindholm:
     "Two small uapi fixes. One patch hardcodes TC* ioctl values that
      previously depended on the deprecated termio struct, avoiding build
      issues with newer glibc versions. The other patch switches uapi
cd ..

nix nar pack linux > linux.nar

cmp <(./nix/bin/nix nar pack linux) <(./lix/bin/nix nar dump-path linux)
cmp <(./nix/bin/nix nar pack linux) <(./narser/bin/narser pack linux) || exit 1
cmp <(./nix/bin/nix nar pack linux) <(./nix-nar/bin/nix-nar dump-path linux)

cmp <(./nix/bin/nix nar cat linux.nar /README) <(./lix/bin/nix nar cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narser/bin/narser cat linux.nar /README) || exit 1
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./narz/bin/narz cat linux.nar /README)
cmp <(./nix/bin/nix nar cat linux.nar /README) <(./nix-nar/bin/nix-nar cat linux.nar /README)

cmp <(./nix/bin/nix nar ls linux.nar /) <(./lix/bin/nix nar ls linux.nar /)
cmp <(./nix/bin/nix nar ls linux.nar /) <(./narser/bin/narser ls linux.nar /) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / 2> /dev/null) <(./narz/bin/narz ls linux.nar / 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar /) <(./nix-nar/bin/nix-nar ls linux.nar /)

cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./lix/bin/nix nar ls linux.nar / -l)
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./narser/bin/narser ls linux.nar / -l) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -l 2> /dev/null) <(./narz/bin/narz ls linux.nar / -l 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 1, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -l) <(./nix-nar/bin/nix-nar ls linux.nar / -l)

cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./lix/bin/nix nar ls linux.nar / -lR)
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./narser/bin/narser ls linux.nar / -lR) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR 2> /dev/null) <(./narz/bin/narz ls linux.nar / -lr 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 3, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -lR) <(./nix-nar/bin/nix-nar ls linux.nar / -lR)

cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./lix/bin/nix nar ls linux.nar / -R)
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./narser/bin/narser ls linux.nar / -R) || exit 1
cmp <(./nix/bin/nix nar ls linux.nar / -R 2> /dev/null) <(./narz/bin/narz ls linux.nar / -r 2> /dev/null)
/dev/fd/63 /dev/fd/62 differ: byte 2, line 1
cmp <(./nix/bin/nix nar ls linux.nar / -R) <(./nix-nar/bin/nix-nar ls linux.nar / -R)


poop -d 60000 "./nix/bin/nix nar pack linux" "./lix/bin/nix nar dump-path linux" "./narser/bin/narser pack linux" "./nix-nar/bin/nix-nar dump-path linux"
Benchmark 1 (32 runs): ./nix/bin/nix nar pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.93s  Â± 51.5ms                              1.89s  â€¦ 2.05s                                     6 (19%)        0%
  peak_rss           38.0MB Â±  109KB                              37.8MB â€¦ 38.2MB                                    0 ( 0%)        0%
  cpu_cycles         3.52G  Â±  170M                               3.40G  â€¦ 3.88G                                     6 (19%)        0%
  instructions       7.52G  Â±  174K                               7.52G  â€¦ 7.52G                                     0 ( 0%)        0%
  cache_references   56.6M  Â± 3.56M                               52.1M  â€¦ 69.0M                                     1 ( 3%)        0%
  cache_misses       4.45M  Â± 46.1K                               4.38M  â€¦ 4.62M                                     2 ( 6%)        0%
  branch_misses      10.8M  Â± 3.70M                               8.32M  â€¦ 18.5M                                     6 (19%)        0%
Benchmark 2 (51 runs): ./lix/bin/nix nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.20s  Â± 18.4ms                              1.18s  â€¦ 1.26s                                     1 ( 2%)        âš¡- 38.0% Â±  0.8%
  peak_rss           33.7MB Â±  183KB                              33.2MB â€¦ 34.1MB                                    0 ( 0%)        âš¡- 11.5% Â±  0.2%
  cpu_cycles         1.40G  Â± 55.4M                               1.35G  â€¦ 1.58G                                     0 ( 0%)        âš¡- 60.2% Â±  1.5%
  instructions       1.86G  Â± 8.64K                               1.86G  â€¦ 1.86G                                     0 ( 0%)        âš¡- 75.2% Â±  0.0%
  cache_references   88.1M  Â± 3.15M                               81.9M  â€¦ 93.8M                                     0 ( 0%)        ðŸ’©+ 55.5% Â±  2.6%
  cache_misses        785K  Â± 41.1K                                752K  â€¦  999K                                     3 ( 6%)        âš¡- 82.3% Â±  0.4%
  branch_misses      4.17M  Â± 1.06M                               3.14M  â€¦ 7.32M                                     0 ( 0%)        âš¡- 61.4% Â± 10.1%
Benchmark 3 (78 runs): ./narser/bin/narser pack linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           770ms Â± 3.56ms                               764ms â€¦  782ms                                    1 ( 1%)        âš¡- 60.1% Â±  0.6%
  peak_rss           1.28MB Â± 59.4KB                              1.18MB â€¦ 1.31MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.1%
  cpu_cycles          240M  Â± 1.72M                                235M  â€¦  244M                                     1 ( 1%)        âš¡- 93.2% Â±  1.1%
  instructions        436M  Â± 14.2                                 436M  â€¦  436M                                     2 ( 3%)        âš¡- 94.2% Â±  0.0%
  cache_references   6.67M  Â±  753K                               5.66M  â€¦ 8.58M                                     0 ( 0%)        âš¡- 88.2% Â±  1.5%
  cache_misses        184K  Â± 8.67K                                159K  â€¦  202K                                     0 ( 0%)        âš¡- 95.9% Â±  0.2%
  branch_misses       755K  Â± 6.16K                                742K  â€¦  769K                                     0 ( 0%)        âš¡- 93.0% Â±  7.6%
Benchmark 4 (38 runs): ./nix-nar/bin/nix-nar dump-path linux
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.58s  Â± 9.15ms                              1.57s  â€¦ 1.61s                                     0 ( 0%)        âš¡- 18.1% Â±  0.9%
  peak_rss           2.90MB Â± 88.3KB                              2.72MB â€¦ 3.09MB                                    0 ( 0%)        âš¡- 92.4% Â±  0.1%
  cpu_cycles          552M  Â± 12.2M                                534M  â€¦  589M                                     2 ( 5%)        âš¡- 84.3% Â±  1.6%
  instructions        842M  Â± 85.8K                                842M  â€¦  842M                                     0 ( 0%)        âš¡- 88.8% Â±  0.0%
  cache_references   10.7M  Â±  833K                               9.46M  â€¦ 12.9M                                     0 ( 0%)        âš¡- 81.1% Â±  2.1%
  cache_misses        423K  Â± 31.6K                                379K  â€¦  567K                                     1 ( 3%)        âš¡- 90.5% Â±  0.4%
  branch_misses      2.75M  Â±  217K                               2.49M  â€¦ 3.47M                                     1 ( 3%)        âš¡- 74.5% Â± 11.1%

poop -d 60000 "./nix/bin/nix nar ls linux.nar /" "./lix/bin/nix nar ls linux.nar /" "./narser/bin/narser ls linux.nar /" "./nix-nar/bin/nix-nar ls linux.nar /" "./narz/bin/narz ls linux.nar /"
Benchmark 1 (144 runs): ./nix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           417ms Â± 4.31ms                               410ms â€¦  430ms                                    1 ( 1%)        0%
  peak_rss           71.2MB Â±  130KB                              70.8MB â€¦ 71.5MB                                    0 ( 0%)        0%
  cpu_cycles          574M  Â± 11.9M                                558M  â€¦  616M                                     1 ( 1%)        0%
  instructions       1.12G  Â±  123K                               1.12G  â€¦ 1.12G                                     0 ( 0%)        0%
  cache_references   9.73M  Â± 1.65M                               7.85M  â€¦ 16.7M                                    11 ( 8%)        0%
  cache_misses       2.28M  Â± 19.5K                               2.24M  â€¦ 2.36M                                     3 ( 2%)        0%
  branch_misses      1.73M  Â±  297K                               1.47M  â€¦ 2.87M                                     1 ( 1%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.69s  Â± 8.90ms                              2.68s  â€¦ 2.71s                                     0 ( 0%)        ðŸ’©+546.2% Â±  0.5%
  peak_rss           3.79GB Â±  123KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5224.5% Â±  0.1%
  cpu_cycles         2.98G  Â± 24.1M                               2.94G  â€¦ 3.03G                                     0 ( 0%)        ðŸ’©+418.6% Â±  1.1%
  instructions       2.20G  Â± 7.21K                               2.20G  â€¦ 2.20G                                     0 ( 0%)        ðŸ’©+ 96.2% Â±  0.0%
  cache_references    138M  Â± 2.65M                                135M  â€¦  147M                                     1 ( 4%)        ðŸ’©+1313.1% Â±  8.2%
  cache_misses       71.3M  Â±  153K                               71.0M  â€¦ 71.6M                                     0 ( 0%)        ðŸ’©+3024.0% Â±  1.1%
  branch_misses      4.45M  Â±  491K                               3.84M  â€¦ 5.32M                                     0 ( 0%)        ðŸ’©+156.6% Â±  8.4%
Benchmark 3 (552 runs): ./narser/bin/narser ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           109ms Â±  751us                               108ms â€¦  116ms                                   30 ( 5%)        âš¡- 73.9% Â±  0.1%
  peak_rss           33.8MB Â± 15.7KB                              33.7MB â€¦ 33.8MB                                    8 ( 1%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles         65.5M  Â±  560K                               64.9M  â€¦ 69.1M                                    41 ( 7%)        âš¡- 88.6% Â±  0.2%
  instructions        122M  Â± 4.90                                 122M  â€¦  122M                                     8 ( 1%)        âš¡- 89.1% Â±  0.0%
  cache_references   1.20M  Â± 37.5K                               1.12M  â€¦ 1.36M                                    16 ( 3%)        âš¡- 87.6% Â±  1.4%
  cache_misses       17.7K  Â± 1.52K                               14.7K  â€¦ 24.4K                                    53 (10%)        âš¡- 99.2% Â±  0.1%
  branch_misses       396K  Â± 3.34K                                393K  â€¦  424K                                    54 (10%)        âš¡- 77.2% Â±  1.4%
Benchmark 4 (111 runs): ./nix-nar/bin/nix-nar ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           544ms Â± 4.38ms                               539ms â€¦  573ms                                    2 ( 2%)        ðŸ’©+ 30.5% Â±  0.3%
  peak_rss           2.40MB Â± 58.2KB                              2.28MB â€¦ 2.55MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles          956M  Â± 12.7M                                944M  â€¦ 1.05G                                     4 ( 4%)        ðŸ’©+ 66.6% Â±  0.5%
  instructions       1.53G  Â± 81.2K                               1.53G  â€¦ 1.53G                                     0 ( 0%)        ðŸ’©+ 36.5% Â±  0.0%
  cache_references   11.0M  Â± 3.50M                               5.27M  â€¦ 25.3M                                     2 ( 2%)        ðŸ’©+ 13.4% Â±  6.7%
  cache_misses       60.2K  Â± 8.99K                               45.3K  â€¦ 79.8K                                     0 ( 0%)        âš¡- 97.4% Â±  0.2%
  branch_misses      1.15M  Â±  174K                               1.01M  â€¦ 2.41M                                     2 ( 2%)        âš¡- 33.5% Â±  3.6%
Benchmark 5 (16 runs): ./narz/bin/narz ls linux.nar /
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.76s  Â± 5.44ms                              3.75s  â€¦ 3.77s                                     0 ( 0%)        ðŸ’©+802.4% Â±  0.5%
  peak_rss           1.86GB Â± 65.5KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+2519.1% Â±  0.1%
  cpu_cycles          892M  Â± 2.32M                                888M  â€¦  896M                                     0 ( 0%)        ðŸ’©+ 55.6% Â±  1.0%
  instructions        879M  Â±  184                                 879M  â€¦  879M                                     1 ( 6%)        âš¡- 21.7% Â±  0.0%
  cache_references   5.40M  Â±  546K                               4.69M  â€¦ 6.27M                                     0 ( 0%)        âš¡- 44.5% Â±  8.4%
  cache_misses        122K  Â± 4.87K                                114K  â€¦  131K                                     0 ( 0%)        âš¡- 94.7% Â±  0.4%
  branch_misses      1.81M  Â± 40.8K                               1.75M  â€¦ 1.88M                                     0 ( 0%)          +  4.5% Â±  8.4%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -R" "./lix/bin/nix nar ls linux.nar / -R" "./narser/bin/narser ls linux.nar / -R" "./nix-nar/bin/nix-nar ls linux.nar / -R" "./narz/bin/narz ls linux.nar / -r"
Benchmark 1 (92 runs): ./nix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           653ms Â± 9.26ms                               641ms â€¦  680ms                                    0 ( 0%)        0%
  peak_rss           71.2MB Â±  132KB                              70.8MB â€¦ 71.4MB                                    0 ( 0%)        0%
  cpu_cycles          982M  Â± 30.1M                                950M  â€¦ 1.05G                                     0 ( 0%)        0%
  instructions       1.85G  Â±  393K                               1.85G  â€¦ 1.85G                                     4 ( 4%)        0%
  cache_references   20.3M  Â± 3.21M                               17.8M  â€¦ 36.5M                                     8 ( 9%)        0%
  cache_misses       4.76M  Â± 81.3K                               4.66M  â€¦ 5.01M                                     2 ( 2%)        0%
  branch_misses      4.26M  Â±  748K                               3.60M  â€¦ 5.99M                                     0 ( 0%)        0%
Benchmark 2 (21 runs): ./lix/bin/nix nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.96s  Â± 14.8ms                              2.94s  â€¦ 3.00s                                     1 ( 5%)        ðŸ’©+352.9% Â±  0.8%
  peak_rss           3.79GB Â±  147KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5222.8% Â±  0.1%
  cpu_cycles         3.46G  Â± 34.2M                               3.41G  â€¦ 3.55G                                     1 ( 5%)        ðŸ’©+251.8% Â±  1.5%
  instructions       3.06G  Â±  714K                               3.06G  â€¦ 3.07G                                     0 ( 0%)        ðŸ’©+ 65.6% Â±  0.0%
  cache_references    141M  Â± 5.43M                                137M  â€¦  160M                                     1 ( 5%)        ðŸ’©+596.1% Â±  8.8%
  cache_misses       72.1M  Â±  153K                               71.9M  â€¦ 72.5M                                     1 ( 5%)        ðŸ’©+1414.4% Â±  1.0%
  branch_misses      6.23M  Â±  601K                               5.40M  â€¦ 8.03M                                     2 (10%)        ðŸ’©+ 46.4% Â±  8.1%
Benchmark 3 (456 runs): ./narser/bin/narser ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           132ms Â± 2.15ms                               130ms â€¦  148ms                                   72 (16%)        âš¡- 79.9% Â±  0.1%
  peak_rss           33.8MB Â± 18.3KB                              33.7MB â€¦ 33.8MB                                    9 ( 2%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles          144M  Â± 5.04M                                139M  â€¦  159M                                   122 (27%)        âš¡- 85.4% Â±  0.3%
  instructions        307M  Â± 7.22                                 307M  â€¦  307M                                     6 ( 1%)        âš¡- 83.4% Â±  0.0%
  cache_references   2.30M  Â± 36.9K                               2.20M  â€¦ 2.41M                                    11 ( 2%)        âš¡- 88.7% Â±  1.4%
  cache_misses        910K  Â± 15.2K                                874K  â€¦  981K                                    83 (18%)        âš¡- 80.9% Â±  0.2%
  branch_misses       555K  Â± 4.70K                                551K  â€¦  601K                                    39 ( 9%)        âš¡- 87.0% Â±  1.6%
Benchmark 4 (91 runs): ./nix-nar/bin/nix-nar ls linux.nar / -R
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           662ms Â± 4.04ms                               658ms â€¦  685ms                                    5 ( 5%)        ðŸ’©+  1.3% Â±  0.3%
  peak_rss           14.2MB Â± 74.6KB                              14.0MB â€¦ 14.3MB                                    0 ( 0%)        âš¡- 80.1% Â±  0.0%
  cpu_cycles         1.14G  Â± 8.96M                               1.13G  â€¦ 1.18G                                     5 ( 5%)        ðŸ’©+ 16.4% Â±  0.7%
  instructions       1.99G  Â± 80.8K                               1.99G  â€¦ 1.99G                                     0 ( 0%)        ðŸ’©+  7.3% Â±  0.0%
  cache_references   13.7M  Â± 2.44M                               8.53M  â€¦ 21.7M                                     2 ( 2%)        âš¡- 32.6% Â±  4.1%
  cache_misses        180K  Â± 9.03K                                166K  â€¦  198K                                     0 ( 0%)        âš¡- 96.2% Â±  0.4%
  branch_misses      1.60M  Â±  118K                               1.44M  â€¦ 2.28M                                     4 ( 4%)        âš¡- 62.5% Â±  3.7%
Benchmark 5 (16 runs): ./narz/bin/narz ls linux.nar / -r
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.93s  Â± 9.92ms                              3.92s  â€¦ 3.96s                                     1 ( 6%)        ðŸ’©+501.4% Â±  0.8%
  peak_rss           1.86GB Â± 59.8KB                              1.86GB â€¦ 1.86GB                                    4 (25%)        ðŸ’©+2519.0% Â±  0.1%
  cpu_cycles          978M  Â± 2.85M                                974M  â€¦  984M                                     0 ( 0%)          -  0.4% Â±  1.5%
  instructions        961M  Â±  114                                 961M  â€¦  961M                                     0 ( 0%)        âš¡- 48.0% Â±  0.0%
  cache_references   6.32M  Â±  555K                               5.79M  â€¦ 7.28M                                     0 ( 0%)        âš¡- 68.9% Â±  7.9%
  cache_misses        876K  Â± 3.78K                                870K  â€¦  881K                                     0 ( 0%)        âš¡- 81.6% Â±  0.9%
  branch_misses      2.08M  Â± 38.9K                               2.02M  â€¦ 2.16M                                     0 ( 0%)        âš¡- 51.1% Â±  8.7%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -Rl" "./lix/bin/nix nar ls linux.nar / -Rl" "./narser/bin/narser ls linux.nar / -Rl" "./nix-nar/bin/nix-nar ls linux.nar / -Rl" "./narz/bin/narz ls linux.nar / -rl"
Benchmark 1 (81 runs): ./nix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           741ms Â± 13.1ms                               724ms â€¦  772ms                                    0 ( 0%)        0%
  peak_rss           71.1MB Â±  123KB                              70.9MB â€¦ 71.4MB                                    0 ( 0%)        0%
  cpu_cycles         1.29G  Â± 43.7M                               1.24G  â€¦ 1.39G                                     2 ( 2%)        0%
  instructions       2.55G  Â±  398K                               2.55G  â€¦ 2.56G                                     1 ( 1%)        0%
  cache_references   21.1M  Â± 2.00M                               19.3M  â€¦ 31.4M                                     4 ( 5%)        0%
  cache_misses       4.97M  Â± 93.6K                               4.82M  â€¦ 5.31M                                     1 ( 1%)        0%
  branch_misses      4.78M  Â±  947K                               4.02M  â€¦ 6.91M                                    17 (21%)        0%
Benchmark 2 (20 runs): ./lix/bin/nix nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.08s  Â± 22.2ms                              3.05s  â€¦ 3.14s                                     1 ( 5%)        ðŸ’©+316.1% Â±  1.0%
  peak_rss           3.79GB Â±  141KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5225.9% Â±  0.1%
  cpu_cycles         3.89G  Â± 58.8M                               3.82G  â€¦ 4.04G                                     0 ( 0%)        ðŸ’©+202.5% Â±  1.8%
  instructions       3.96G  Â±  973K                               3.96G  â€¦ 3.97G                                     1 ( 5%)        ðŸ’©+ 55.1% Â±  0.0%
  cache_references    143M  Â± 4.89M                                138M  â€¦  157M                                     0 ( 0%)        ðŸ’©+579.9% Â±  6.6%
  cache_misses       72.1M  Â±  283K                               71.3M  â€¦ 72.7M                                     2 (10%)        ðŸ’©+1351.5% Â±  1.5%
  branch_misses      7.65M  Â± 1.19M                               6.12M  â€¦ 10.1M                                     0 ( 0%)        ðŸ’©+ 60.3% Â± 10.4%
Benchmark 3 (443 runs): ./narser/bin/narser ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           136ms Â± 2.47ms                               133ms â€¦  153ms                                    6 ( 1%)        âš¡- 81.7% Â±  0.2%
  peak_rss           33.8MB Â± 20.4KB                              33.7MB â€¦ 33.8MB                                   11 ( 2%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles          156M  Â± 5.27M                                151M  â€¦  171M                                    73 (16%)        âš¡- 87.9% Â±  0.3%
  instructions        350M  Â± 9.58                                 350M  â€¦  350M                                    23 ( 5%)        âš¡- 86.3% Â±  0.0%
  cache_references   2.39M  Â± 45.8K                               2.26M  â€¦ 2.55M                                    17 ( 4%)        âš¡- 88.7% Â±  0.9%
  cache_misses        921K  Â± 20.6K                                870K  â€¦ 1000K                                    81 (18%)        âš¡- 81.5% Â±  0.2%
  branch_misses       601K  Â± 6.34K                                596K  â€¦  653K                                    65 (15%)        âš¡- 87.4% Â±  1.8%
Benchmark 4 (87 runs): ./nix-nar/bin/nix-nar ls linux.nar / -Rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           697ms Â± 5.09ms                               688ms â€¦  721ms                                    3 ( 3%)        âš¡-  6.0% Â±  0.4%
  peak_rss           14.1MB Â± 68.4KB                              14.0MB â€¦ 14.3MB                                    0 ( 0%)        âš¡- 80.1% Â±  0.0%
  cpu_cycles         1.25G  Â± 11.6M                               1.23G  â€¦ 1.30G                                     1 ( 1%)        âš¡-  2.5% Â±  0.7%
  instructions       2.25G  Â±  849K                               2.25G  â€¦ 2.26G                                     3 ( 3%)        âš¡- 11.9% Â±  0.0%
  cache_references   15.3M  Â± 3.79M                               10.1M  â€¦ 28.9M                                     1 ( 1%)        âš¡- 27.3% Â±  4.4%
  cache_misses        300K  Â± 8.10K                                283K  â€¦  314K                                     0 ( 0%)        âš¡- 94.0% Â±  0.4%
  branch_misses      1.99M  Â±  232K                               1.62M  â€¦ 2.82M                                     1 ( 1%)        âš¡- 58.4% Â±  4.3%
Benchmark 5 (12 runs): ./narz/bin/narz ls linux.nar / -rl
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          5.16s  Â± 14.7ms                              5.14s  â€¦ 5.19s                                     2 (17%)        ðŸ’©+596.8% Â±  1.1%
  peak_rss           1.86GB Â± 84.3KB                              1.86GB â€¦ 1.86GB                                    3 (25%)        ðŸ’©+2520.5% Â±  0.1%
  cpu_cycles         1.16G  Â± 3.50M                               1.15G  â€¦ 1.17G                                     1 ( 8%)        âš¡-  9.9% Â±  2.0%
  instructions       1.13G  Â±  123                                1.13G  â€¦ 1.13G                                     2 (17%)        âš¡- 55.8% Â±  0.0%
  cache_references   6.12M  Â±  456K                               5.36M  â€¦ 7.21M                                     3 (25%)        âš¡- 71.0% Â±  5.5%
  cache_misses        885K  Â± 6.15K                                872K  â€¦  895K                                     1 ( 8%)        âš¡- 82.2% Â±  1.1%
  branch_misses      2.49M  Â± 56.0K                               2.39M  â€¦ 2.57M                                     0 ( 0%)        âš¡- 47.8% Â± 11.4%

poop -d 60000 "./nix/bin/nix nar ls linux.nar / -l" "./lix/bin/nix nar ls linux.nar / -l" "./narser/bin/narser ls linux.nar / -l" "./nix-nar/bin/nix-nar ls linux.nar / -l" "./narz/bin/narz ls linux.nar / -l"
Benchmark 1 (144 runs): ./nix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           417ms Â± 5.24ms                               410ms â€¦  446ms                                    4 ( 3%)        0%
  peak_rss           71.2MB Â±  130KB                              70.9MB â€¦ 71.7MB                                    1 ( 1%)        0%
  cpu_cycles          574M  Â± 13.7M                                557M  â€¦  634M                                     4 ( 3%)        0%
  instructions       1.12G  Â±  101K                               1.12G  â€¦ 1.12G                                     0 ( 0%)        0%
  cache_references   9.91M  Â± 2.37M                               7.41M  â€¦ 29.1M                                    11 ( 8%)        0%
  cache_misses       2.28M  Â± 23.8K                               2.23M  â€¦ 2.36M                                     3 ( 2%)        0%
  branch_misses      1.74M  Â±  295K                               1.47M  â€¦ 2.88M                                     1 ( 1%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.69s  Â± 12.0ms                              2.67s  â€¦ 2.71s                                     0 ( 0%)        ðŸ’©+544.0% Â±  0.7%
  peak_rss           3.79GB Â±  108KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+5224.3% Â±  0.1%
  cpu_cycles         2.97G  Â± 19.5M                               2.94G  â€¦ 3.01G                                     0 ( 0%)        ðŸ’©+417.4% Â±  1.1%
  instructions       2.20G  Â± 7.64K                               2.20G  â€¦ 2.20G                                     0 ( 0%)        ðŸ’©+ 96.2% Â±  0.0%
  cache_references    139M  Â± 3.49M                                135M  â€¦  151M                                     1 ( 4%)        ðŸ’©+1300.6% Â± 11.3%
  cache_misses       71.3M  Â±  224K                               70.7M  â€¦ 71.8M                                     1 ( 4%)        ðŸ’©+3029.8% Â±  1.6%
  branch_misses      4.21M  Â±  318K                               3.81M  â€¦ 4.82M                                     0 ( 0%)        ðŸ’©+141.6% Â±  7.5%
Benchmark 3 (550 runs): ./narser/bin/narser ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           109ms Â± 1.34ms                               108ms â€¦  126ms                                   12 ( 2%)        âš¡- 73.9% Â±  0.1%
  peak_rss           33.8MB Â± 22.0KB                              33.7MB â€¦ 33.8MB                                   16 ( 3%)        âš¡- 52.5% Â±  0.0%
  cpu_cycles         65.8M  Â±  850K                               64.9M  â€¦ 72.8M                                     5 ( 1%)        âš¡- 88.5% Â±  0.2%
  instructions        122M  Â± 4.87                                 122M  â€¦  122M                                     2 ( 0%)        âš¡- 89.1% Â±  0.0%
  cache_references   1.21M  Â± 38.9K                               1.12M  â€¦ 1.34M                                     6 ( 1%)        âš¡- 87.8% Â±  2.0%
  cache_misses       17.1K  Â± 1.74K                               13.7K  â€¦ 23.0K                                    43 ( 8%)        âš¡- 99.3% Â±  0.1%
  branch_misses       396K  Â± 4.17K                                393K  â€¦  440K                                    58 (11%)        âš¡- 77.3% Â±  1.4%
Benchmark 4 (111 runs): ./nix-nar/bin/nix-nar ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           541ms Â± 3.68ms                               538ms â€¦  564ms                                    7 ( 6%)        ðŸ’©+ 29.7% Â±  0.3%
  peak_rss           2.40MB Â± 58.6KB                              2.28MB â€¦ 2.56MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles          952M  Â± 7.53M                                943M  â€¦  987M                                     8 ( 7%)        ðŸ’©+ 65.8% Â±  0.5%
  instructions       1.53G  Â± 82.5K                               1.53G  â€¦ 1.53G                                     0 ( 0%)        ðŸ’©+ 36.5% Â±  0.0%
  cache_references   10.8M  Â± 3.34M                               5.13M  â€¦ 22.3M                                     4 ( 4%)        ðŸ’©+  8.8% Â±  7.1%
  cache_misses       58.7K  Â± 7.87K                               45.4K  â€¦ 75.2K                                     0 ( 0%)        âš¡- 97.4% Â±  0.2%
  branch_misses      1.08M  Â±  102K                               1.00M  â€¦ 1.70M                                     8 ( 7%)        âš¡- 37.8% Â±  3.3%
Benchmark 5 (17 runs): ./narz/bin/narz ls linux.nar / -l
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.74s  Â± 13.3ms                              3.73s  â€¦ 3.77s                                     0 ( 0%)        ðŸ’©+796.6% Â±  0.8%
  peak_rss           1.86GB Â± 57.3KB                              1.86GB â€¦ 1.86GB                                    4 (24%)        ðŸ’©+2519.1% Â±  0.1%
  cpu_cycles          889M  Â± 2.48M                                884M  â€¦  893M                                     0 ( 0%)        ðŸ’©+ 54.8% Â±  1.1%
  instructions        879M  Â±  143                                 879M  â€¦  879M                                     0 ( 0%)        âš¡- 21.7% Â±  0.0%
  cache_references   4.94M  Â±  260K                               4.68M  â€¦ 5.71M                                     1 ( 6%)        âš¡- 50.2% Â± 11.4%
  cache_misses        118K  Â± 6.57K                                108K  â€¦  137K                                     1 ( 6%)        âš¡- 94.8% Â±  0.5%
  branch_misses      1.78M  Â± 32.1K                               1.72M  â€¦ 1.84M                                     0 ( 0%)          +  2.0% Â±  8.1%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /README" "./lix/bin/nix nar cat linux.nar /README" "./narser/bin/narser cat linux.nar /README" "./narser/bin/narser cat linux.nar /README -f" "./narser/bin/narser cat linux.nar /README -L" "./nix-nar/bin/nix-nar cat linux.nar /README " "./narz/bin/narz cat linux.nar /README"
Benchmark 1 (333 runs): ./nix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           180ms Â± 3.12ms                               177ms â€¦  202ms                                    5 ( 2%)        0%
  peak_rss           30.5MB Â±  177KB                              30.1MB â€¦ 31.0MB                                    0 ( 0%)        0%
  cpu_cycles          269M  Â± 8.22M                                261M  â€¦  319M                                     3 ( 1%)        0%
  instructions        644M  Â±  115K                                644M  â€¦  644M                                     4 ( 1%)        0%
  cache_references   2.46M  Â±  258K                               2.05M  â€¦ 4.49M                                    16 ( 5%)        0%
  cache_misses        366K  Â± 14.0K                                350K  â€¦  452K                                    55 (17%)        0%
  branch_misses       720K  Â±  185K                                564K  â€¦ 1.65M                                     3 ( 1%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.70s  Â± 10.3ms                              2.68s  â€¦ 2.72s                                     0 ( 0%)        ðŸ’©+1398.8% Â±  0.9%
  peak_rss           3.79GB Â±  151KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+12308.2% Â±  0.2%
  cpu_cycles         3.00G  Â± 23.5M                               2.96G  â€¦ 3.04G                                     0 ( 0%)        ðŸ’©+1013.3% Â±  1.6%
  instructions       2.23G  Â± 8.20K                               2.23G  â€¦ 2.23G                                     0 ( 0%)        ðŸ’©+246.7% Â±  0.0%
  cache_references    138M  Â± 2.96M                                134M  â€¦  146M                                     0 ( 0%)        ðŸ’©+5522.0% Â± 13.4%
  cache_misses       72.3M  Â±  133K                               72.0M  â€¦ 72.5M                                     0 ( 0%)        ðŸ’©+19663.9% Â±  4.1%
  branch_misses      4.51M  Â±  402K                               3.87M  â€¦ 5.20M                                     0 ( 0%)        ðŸ’©+526.2% Â± 12.1%
Benchmark 3 (691 runs): ./narser/bin/narser cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          86.9ms Â± 1.40ms                              86.2ms â€¦  103ms                                   44 ( 6%)        âš¡- 51.8% Â±  0.2%
  peak_rss           1.05MB Â±    0                                1.05MB â€¦ 1.05MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         45.8M  Â±  527K                               45.5M  â€¦ 51.2M                                    59 ( 9%)        âš¡- 83.0% Â±  0.2%
  instructions       95.5M  Â± 4.89                                95.5M  â€¦ 95.5M                                    15 ( 2%)        âš¡- 85.2% Â±  0.0%
  cache_references    127K  Â± 19.7K                               85.4K  â€¦  195K                                    14 ( 2%)        âš¡- 94.9% Â±  0.8%
  cache_misses       5.21K  Â± 1.22K                               3.73K  â€¦ 10.1K                                    62 ( 9%)        âš¡- 98.6% Â±  0.3%
  branch_misses       381K  Â± 4.74K                                378K  â€¦  435K                                    61 ( 9%)        âš¡- 47.0% Â±  1.9%
Benchmark 4 (6834 runs): ./narser/bin/narser cat linux.nar /README -f
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          8.73ms Â±  311us                              8.59ms â€¦ 15.9ms                                  313 ( 5%)        âš¡- 95.2% Â±  0.0%
  peak_rss           1.05MB Â± 1.12KB                               983KB â€¦ 1.05MB                                    2 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         5.53M  Â±  149K                               5.47M  â€¦ 9.04M                                   345 ( 5%)        âš¡- 97.9% Â±  0.1%
  instructions       11.1M  Â± 1.76                                11.1M  â€¦ 11.1M                                    44 ( 1%)        âš¡- 98.3% Â±  0.0%
  cache_references   22.4K  Â± 2.72K                               17.2K  â€¦ 58.9K                                   173 ( 3%)        âš¡- 99.1% Â±  0.2%
  cache_misses       1.42K  Â±  288                                 990   â€¦ 4.88K                                   261 ( 4%)        âš¡- 99.6% Â±  0.1%
  branch_misses      50.7K  Â±  922                                49.3K  â€¦ 68.0K                                   110 ( 2%)        âš¡- 93.0% Â±  0.6%
Benchmark 5 (57 runs): ./narser/bin/narser cat linux.nar /README -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.06s  Â± 5.58ms                              1.05s  â€¦ 1.07s                                     0 ( 0%)        ðŸ’©+487.1% Â±  0.6%
  peak_rss           1.90GB Â± 55.5KB                              1.90GB â€¦ 1.90GB                                   13 (23%)        ðŸ’©+6126.4% Â±  0.2%
  cpu_cycles          203M  Â± 1.03M                                201M  â€¦  206M                                     0 ( 0%)        âš¡- 24.4% Â±  0.8%
  instructions        241M  Â± 10.2                                 241M  â€¦  241M                                     0 ( 0%)        âš¡- 62.6% Â±  0.0%
  cache_references   6.78M  Â±  362K                               6.10M  â€¦ 7.50M                                     0 ( 0%)        ðŸ’©+175.6% Â±  3.1%
  cache_misses        242K  Â± 9.98K                                226K  â€¦  262K                                     0 ( 0%)        âš¡- 33.9% Â±  1.0%
  branch_misses       643K  Â± 10.1K                                615K  â€¦  671K                                     4 ( 7%)        âš¡- 10.7% Â±  6.7%
Benchmark 6 (732 runs): ./nix-nar/bin/nix-nar cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          81.9ms Â± 1.88ms                              80.7ms â€¦  107ms                                   87 (12%)        âš¡- 54.5% Â±  0.2%
  peak_rss           2.40MB Â± 61.3KB                              2.28MB â€¦ 2.55MB                                    0 ( 0%)        âš¡- 92.1% Â±  0.0%
  cpu_cycles          116M  Â± 3.04M                                114M  â€¦  167M                                    50 ( 7%)        âš¡- 57.0% Â±  0.3%
  instructions        167M  Â± 10.2K                                167M  â€¦  167M                                     0 ( 0%)        âš¡- 74.0% Â±  0.0%
  cache_references   1.61M  Â±  455K                                736K  â€¦ 3.69M                                    17 ( 2%)        âš¡- 34.4% Â±  2.1%
  cache_misses       21.4K  Â± 2.19K                               18.3K  â€¦ 33.7K                                    65 ( 9%)        âš¡- 94.2% Â±  0.3%
  branch_misses       122K  Â± 53.5K                                107K  â€¦  979K                                    74 (10%)        âš¡- 83.0% Â±  2.0%
Benchmark 7 (16 runs): ./narz/bin/narz cat linux.nar /README
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.76s  Â± 12.0ms                              3.73s  â€¦ 3.78s                                     0 ( 0%)        ðŸ’©+1986.8% Â±  1.1%
  peak_rss           1.86GB Â± 67.2KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+6002.4% Â±  0.3%
  cpu_cycles          891M  Â± 3.18M                                886M  â€¦  897M                                     0 ( 0%)        ðŸ’©+231.3% Â±  1.5%
  instructions        879M  Â± 11.1K                                879M  â€¦  879M                                     2 (13%)        ðŸ’©+ 36.4% Â±  0.0%
  cache_references   4.81M  Â±  489K                               4.14M  â€¦ 6.25M                                     4 (25%)        ðŸ’©+ 95.9% Â±  5.6%
  cache_misses        122K  Â± 4.77K                                114K  â€¦  131K                                     0 ( 0%)        âš¡- 66.7% Â±  1.9%
  branch_misses      1.80M  Â± 31.7K                               1.74M  â€¦ 1.86M                                     0 ( 0%)        ðŸ’©+149.7% Â± 12.6%

poop -d 60000 "./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -f" "./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L" "./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c " "./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c"
Benchmark 1 (334 runs): ./nix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           180ms Â± 2.65ms                               177ms â€¦  194ms                                    6 ( 2%)        0%
  peak_rss           30.5MB Â±  174KB                              30.1MB â€¦ 31.1MB                                    1 ( 0%)        0%
  cpu_cycles          269M  Â± 7.73M                                262M  â€¦  298M                                     2 ( 1%)        0%
  instructions        644M  Â±  114K                                644M  â€¦  645M                                     2 ( 1%)        0%
  cache_references   2.44M  Â±  217K                               2.04M  â€¦ 3.37M                                    10 ( 3%)        0%
  cache_misses        366K  Â± 13.3K                                349K  â€¦  444K                                    58 (17%)        0%
  branch_misses       719K  Â±  177K                                568K  â€¦ 1.47M                                     2 ( 1%)        0%
Benchmark 2 (23 runs): ./lix/bin/nix nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          2.69s  Â± 12.7ms                              2.67s  â€¦ 2.72s                                     2 ( 9%)        ðŸ’©+1393.6% Â±  1.0%
  peak_rss           3.79GB Â± 97.7KB                              3.79GB â€¦ 3.79GB                                    0 ( 0%)        ðŸ’©+12309.5% Â±  0.2%
  cpu_cycles         2.98G  Â± 25.5M                               2.96G  â€¦ 3.06G                                     0 ( 0%)        ðŸ’©+1008.8% Â±  1.5%
  instructions       2.23G  Â± 8.77K                               2.23G  â€¦ 2.23G                                     0 ( 0%)        ðŸ’©+246.6% Â±  0.0%
  cache_references    139M  Â± 5.53M                                133M  â€¦  159M                                     1 ( 4%)        ðŸ’©+5585.7% Â± 24.1%
  cache_misses       72.4M  Â±  144K                               72.1M  â€¦ 72.7M                                     0 ( 0%)        ðŸ’©+19694.0% Â±  4.4%
  branch_misses      4.26M  Â±  429K                               3.87M  â€¦ 5.52M                                     0 ( 0%)        ðŸ’©+492.6% Â± 11.9%
Benchmark 3 (691 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          86.8ms Â± 1.16ms                              86.2ms â€¦  103ms                                   48 ( 7%)        âš¡- 51.8% Â±  0.1%
  peak_rss           1.04MB Â±    0                                1.04MB â€¦ 1.04MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         45.8M  Â±  435K                               45.5M  â€¦ 50.2M                                    57 ( 8%)        âš¡- 83.0% Â±  0.2%
  instructions       95.5M  Â± 5.12                                95.5M  â€¦ 95.5M                                    14 ( 2%)        âš¡- 85.2% Â±  0.0%
  cache_references    129K  Â± 18.6K                               87.4K  â€¦  185K                                    15 ( 2%)        âš¡- 94.7% Â±  0.7%
  cache_misses       5.30K  Â± 1.21K                               3.77K  â€¦ 11.4K                                    61 ( 9%)        âš¡- 98.6% Â±  0.3%
  branch_misses       381K  Â± 3.77K                                378K  â€¦  425K                                    43 ( 6%)        âš¡- 47.0% Â±  1.8%
Benchmark 4 (691 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -f
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          86.9ms Â± 1.36ms                              86.2ms â€¦  103ms                                   60 ( 9%)        âš¡- 51.7% Â±  0.1%
  peak_rss           1.04MB Â±    0                                1.04MB â€¦ 1.04MB                                    0 ( 0%)        âš¡- 96.6% Â±  0.0%
  cpu_cycles         45.8M  Â±  510K                               45.5M  â€¦ 50.7M                                    79 (11%)        âš¡- 83.0% Â±  0.2%
  instructions       95.5M  Â± 5.31                                95.5M  â€¦ 95.5M                                    18 ( 3%)        âš¡- 85.2% Â±  0.0%
  cache_references    129K  Â± 18.6K                               87.1K  â€¦  201K                                    15 ( 2%)        âš¡- 94.7% Â±  0.7%
  cache_misses       5.37K  Â± 1.21K                               3.88K  â€¦ 10.5K                                    65 ( 9%)        âš¡- 98.5% Â±  0.3%
  branch_misses       381K  Â± 4.27K                                378K  â€¦  434K                                    63 ( 9%)        âš¡- 46.9% Â±  1.8%
Benchmark 5 (57 runs): ./narser/bin/narser cat linux.nar /virt/lib/irqbypass.c -L
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          1.06s  Â± 6.69ms                              1.05s  â€¦ 1.08s                                     6 (11%)        ðŸ’©+487.7% Â±  0.6%
  peak_rss           1.90GB Â± 58.2KB                              1.90GB â€¦ 1.90GB                                    0 ( 0%)        ðŸ’©+6127.0% Â±  0.1%
  cpu_cycles          203M  Â±  934K                                202M  â€¦  206M                                     0 ( 0%)        âš¡- 24.3% Â±  0.7%
  instructions        241M  Â± 8.96                                 241M  â€¦  241M                                     0 ( 0%)        âš¡- 62.6% Â±  0.0%
  cache_references   6.83M  Â±  414K                               6.29M  â€¦ 8.22M                                     5 ( 9%)        ðŸ’©+179.9% Â±  2.9%
  cache_misses        243K  Â± 9.23K                                225K  â€¦  265K                                     0 ( 0%)        âš¡- 33.6% Â±  1.0%
  branch_misses       642K  Â± 10.6K                                619K  â€¦  673K                                     2 ( 4%)        âš¡- 10.6% Â±  6.4%
Benchmark 6 (114 runs): ./nix-nar/bin/nix-nar cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time           528ms Â± 4.64ms                               522ms â€¦  554ms                                    5 ( 4%)        ðŸ’©+193.5% Â±  0.4%
  peak_rss           2.40MB Â± 57.0KB                              2.27MB â€¦ 2.54MB                                    0 ( 0%)        âš¡- 92.2% Â±  0.1%
  cpu_cycles          902M  Â± 10.3M                                890M  â€¦  955M                                     7 ( 6%)        ðŸ’©+235.6% Â±  0.7%
  instructions       1.40G  Â± 80.3K                               1.40G  â€¦ 1.40G                                     0 ( 0%)        ðŸ’©+117.3% Â±  0.0%
  cache_references   9.39M  Â± 3.29M                               4.88M  â€¦ 27.3M                                     7 ( 6%)        ðŸ’©+284.7% Â± 14.5%
  cache_misses       45.4K  Â± 6.52K                               34.4K  â€¦ 61.1K                                     0 ( 0%)        âš¡- 87.6% Â±  0.7%
  branch_misses      1.04M  Â±  160K                                889K  â€¦ 1.62M                                     6 ( 5%)        ðŸ’©+ 44.8% Â±  5.1%
Benchmark 7 (17 runs): ./narz/bin/narz cat linux.nar /virt/lib/irqbypass.c
  measurement          mean Â± Ïƒ            min â€¦ max           outliers         delta
  wall_time          3.74s  Â± 5.70ms                              3.73s  â€¦ 3.75s                                     3 (18%)        ðŸ’©+1979.4% Â±  0.8%
  peak_rss           1.86GB Â± 61.6KB                              1.86GB â€¦ 1.86GB                                    0 ( 0%)        ðŸ’©+6003.1% Â±  0.3%
  cpu_cycles          889M  Â± 2.83M                                884M  â€¦  896M                                     0 ( 0%)        ðŸ’©+230.7% Â±  1.4%
  instructions        879M  Â± 13.2K                                879M  â€¦  879M                                     0 ( 0%)        ðŸ’©+ 36.4% Â±  0.0%
  cache_references   5.52M  Â±  711K                               4.42M  â€¦ 6.46M                                     0 ( 0%)        ðŸ’©+126.1% Â±  5.2%
  cache_misses        117K  Â± 4.78K                                109K  â€¦  127K                                     0 ( 0%)        âš¡- 67.9% Â±  1.7%
  branch_misses      1.77M  Â± 38.3K                               1.69M  â€¦ 1.82M                                     0 ( 0%)        ðŸ’©+145.7% Â± 11.7%

./nix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./lix/bin/nix-store --restore out < linux.nar
cmp <(./nix/bin/nix nar pack out) linux.nar
rm -rf out

./narser/bin/narser unpack linux.nar out
cmp <(./nix/bin/nix nar pack out) linux.nar || exit 1
rm -rf out

rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.524s
user	0m0.352s
sys	0m1.164s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.515s
user	0m0.316s
sys	0m1.194s
rm -rf out ; time ./nix/bin/nix-store --restore out < linux.nar

real	0m1.517s
user	0m0.352s
sys	0m1.158s

rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.726s
user	0m0.489s
sys	0m1.227s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.729s
user	0m0.506s
sys	0m1.213s
rm -rf out ; time ./lix/bin/nix-store --restore out < linux.nar

real	0m1.731s
user	0m0.544s
sys	0m1.176s

rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.339s
user	0m0.186s
sys	0m1.146s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.320s
user	0m0.203s
sys	0m1.111s
rm -rf out ; time ./narser/bin/narser unpack linux.nar out

real	0m1.321s
user	0m0.203s
sys	0m1.112s
